<div class="chm_content">
 <div id="header">
  <table id="bottomTable">
   <tbody>
    <tr id="headerTableRow3">
     <td align="left">
      <a href="b0e53a4a-84ad-abb4-358d-9797870f101b.htm">
       GlobalParameter Class
      </a>
      <a href="#exampleToggle" >
       Example
      </a>
      <a href="#seeAlsoToggle" >
       SeeÂ Also
      </a>
     </td>
    </tr>
   </tbody>
  </table>
 </div>
 <div id="mainSection">
  <div id="mainBody">
   <div class="saveHistory">
    <span style="color: DarkGray">
    </span>
    <div class="summary">
     Labels a dimension with this global parameter.
    </div>
    <p>
     <b>
      Namespace:
     </b>
     <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">
      Autodesk.Revit.DB
     </a>
     <br/>
     <b>
      Assembly:
     </b>
     <span sdata="assembly">
      RevitAPI
     </span>
     (in RevitAPI.dll) Version: 16.0.0.0 (16.0.0.0)
     <br/>
     <b>
      Since:
     </b>
     2016 Subscription Update
    </p>
    <h1 class="heading">
     Syntax
     <a name="syntaxToggle">
     </a>
    </h1>
    <div class="section" id="syntaxSection" name="collapseableSection" style="">
     <div class="code" id="syntaxCodeBlocks">
      <span codelanguage="CSharp">
       <table>
        <tbody>
         <tr>
          <th>
           C#
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">public</span> <span class="keyword">void</span> <span class="identifier">LabelDimension</span>(
	<a href="44f3f7b1-3229-3404-93c9-dc5e70337dd6.htm">ElementId</a> <span class="parameter">dimensionId</span>
)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
      <span codelanguage="VisualBasicDeclaration">
       <table>
        <tbody>
         <tr>
          <th>
           Visual Basic
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">Public</span> <span class="keyword">Sub</span> <span class="identifier">LabelDimension</span> ( _
	<span class="parameter">dimensionId</span> <span class="keyword">As</span> <a href="44f3f7b1-3229-3404-93c9-dc5e70337dd6.htm">ElementId</a> _
)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
      <span codelanguage="ManagedCPlusPlus">
       <table>
        <tbody>
         <tr>
          <th>
           Visual C++
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">public</span>:
<span class="keyword">void</span> <span class="identifier">LabelDimension</span>(
	<a href="44f3f7b1-3229-3404-93c9-dc5e70337dd6.htm">ElementId</a>^ <span class="parameter">dimensionId</span>
)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
     </div>
     <div id="parameters">
      <h4 class="subHeading">
       Parameters
      </h4>
      <dl paramname="dimensionId">
       <dt>
        <span class="parameter">
         dimensionId
        </span>
       </dt>
       <dd>
        Type:
        <a href="44f3f7b1-3229-3404-93c9-dc5e70337dd6.htm">
         Autodesk.Revit.DB
         ElementId
        </a>
        <br/>
        Id of a dimension element.
       </dd>
      </dl>
     </div>
    </div>
    <h1 class="heading">
     Remarks
     <a name="remarksToggle">
     </a>
    </h1>
    <div class="section" id="remarksSection" name="collapseableSection" style="">
     <p>
      When a dimension is labeled by a global parameters, then its value is either
   controlled by the parameter (non-reporting), or drives the value of the
   parameter (reporting). It is important to note that a reporting parameter
   can label at most one dimension object - meaning, a parameter can be driven
   by one dimension only.
     </p>
     <p>
      If the dimension is already labeled by another global parameter,
   labeling it again will automatically detach it from that parameter.
     </p>
     <p>
      Presently, not just any kind of dimensions may be labeled by a global parameter.
   Typically only single
      <b>
       Linear
      </b>
      and
      <b>
       Angular
      </b>
      dimensions can be labeled,
   but there are other restrictions in effect too. Also, for the value of the parameter
   and dimension labeled by it depend on each other, the data type of the global parameters
   must be either
      <b>
       Length
      </b>
      or
      <b>
       Angle
      </b>
      , since those are the only units a dimension
   can represent. Refer to the
      <span class="nolink">
       [!:CanLabelDimension(Autodesk::Revit::DB::ElementId)]
      </span>
      method to find out whether a particular dimension element may be labeled or not.
     </p>
    </div>
    <h1 class="heading">
     Examples
     <a name="exampleToggle">
     </a>
    </h1>
    <div class="section" id="exampleSection" name="collapseableSection" style="">
     <span codelanguage="CSharp" id="cbc_1" x-lang="CSharp">
      <div class="highlight-title">
       <span class="highlight-copycode" tabindex="0">
        <img src='{{ url_for("static", filename="img/chm/icons/CopyCode.gif") }}' style="margin-right: 5px;"/>
        Copy
       </span>
       C#
      </div>
      <div class="code">
       <pre><code><span class="highlight-comment">/// &lt;summary&gt;</span>
<span class="highlight-comment">/// Creates a global parameter and uses it to label the set of given dimension elements </span>
<span class="highlight-comment">/// &lt;/summary&gt;</span>
<span class="highlight-comment">/// &lt;param name="document"&gt;Revit project document that contains the dimension.&lt;/param&gt;</span>
<span class="highlight-comment">/// &lt;param name="gpname"&gt;A name of the global parameter to create.&lt;/param&gt;</span>
<span class="highlight-comment">/// &lt;param name="value"&gt;Initila value of the global parameter&lt;/param&gt;</span>
<span class="highlight-comment">/// &lt;param name="dimset"&gt;A collection of dimension elements to drive by a global parameter&lt;/param&gt;</span>
<span class="highlight-comment">/// &lt;returns&gt;Number of actually labeled dimension&lt;/returns&gt;</span>
<span class="highlight-keyword">public</span> <span class="highlight-keyword">int</span> DriveSelectedDimensions(Document document, <span class="highlight-keyword">string</span> name, <span class="highlight-keyword">double</span> value, ISet&lt;ElementId&gt; dimset)
{
    <span class="highlight-keyword">if</span> (!GlobalParametersManager.AreGlobalParametersAllowed(document))
        <span class="highlight-keyword">throw</span> <span class="highlight-keyword">new</span> System.InvalidOperationException(<span class="highlight-literal">"Global parameters are not permitted in the given document"</span>);

    <span class="highlight-keyword">if</span> (!GlobalParametersManager.IsUniqueName(document, name))
        <span class="highlight-keyword">throw</span> <span class="highlight-keyword">new</span> System.ArgumentException(<span class="highlight-literal">"Global parameter with such name already exists in the document"</span>, <span class="highlight-literal">"name"</span>);

    <span class="highlight-keyword">if</span> (value &lt;= <span class="highlight-number">0.0</span>)
        <span class="highlight-keyword">throw</span> <span class="highlight-keyword">new</span> System.ArgumentException(<span class="highlight-literal">"Value of a global parameter that drives dimension must be a positive number"</span>, <span class="highlight-literal">"value"</span>);

    <span class="highlight-keyword">int</span> nLabeledDims = <span class="highlight-number">0</span>;   <span class="highlight-comment">// number of labeled dimensions (for testing)</span>

    <span class="highlight-comment">// creation of any element must be in a transaction</span>
    <span class="highlight-keyword">using</span> (Transaction trans = <span class="highlight-keyword">new</span> Transaction(document, <span class="highlight-literal">"Create Global Parameter"</span>))
    {
        trans.Start();

        <span class="highlight-comment">// create a GP with the given name and type Length</span>
        <span class="highlight-comment">// Note: Length (or Angle) is required type of global parameters that are to label a dimension</span>
        GlobalParameter newgp = GlobalParameter.Create(document, name, ParameterType.Length);
        <span class="highlight-keyword">if</span> (newgp != <span class="highlight-keyword">null</span>)
        {
            newgp.SetValue(<span class="highlight-keyword">new</span> DoubleParameterValue(value));

            <span class="highlight-comment">// use the parameter to label the given dimensions</span>
            <span class="highlight-keyword">foreach</span> (ElementId elemid <span class="highlight-keyword">in</span> dimset)
            {
                <span class="highlight-comment">// not just any dimension is allowed to be labeled</span>
                <span class="highlight-comment">// check first to avoid exceptions</span>
                <span class="highlight-keyword">if</span> (newgp.CanLabelDimension(elemid))
                {
                    newgp.LabelDimension(elemid);
                    nLabeledDims += <span class="highlight-number">1</span>;
                }
            }

            trans.Commit();
        }
    }

    <span class="highlight-comment">// for illustration purposes only, we'll test the results of our modifications </span>

    <span class="highlight-comment">// 1.) Check the new parameter can be found</span>

    ElementId gpid = GlobalParametersManager.FindByName(document,name);
    <span class="highlight-keyword">if</span> (gpid == ElementId.InvalidElementId)
    {
        TaskDialog.Show(<span class="highlight-literal">"Error"</span>, <span class="highlight-literal">"Failed to find a newly created global parameter"</span>);
    }

    GlobalParameter gp = document.GetElement(gpid) <span class="highlight-keyword">as</span> GlobalParameter;

    <span class="highlight-comment">// 2. Check the number of labeled dimension is as expected</span>

    ISet&lt;ElementId&gt; labeledSet = gp.GetLabeledDimensions();
    <span class="highlight-keyword">if</span> (labeledSet.Count != nLabeledDims)
    {
        TaskDialog.Show(<span class="highlight-literal">"Error"</span>, <span class="highlight-literal">"Have not found all the dimension that were labeled."</span>);
    }

    <span class="highlight-keyword">return</span> labeledSet.Count;
}</code></pre>
      </div>
     </span>
    </div>
    <h1 class="heading">
     Exceptions
     <a name="exceptionsToggle">
     </a>
    </h1>
    <div class="section" id="exceptionsSection" name="collapseableSection" style="">
     <div class="tableSection">
      <table frame="lhs" width="100%">
       <tbody>
        <tr>
         <th class="exceptionNameColumn">
          Exception
         </th>
         <th class="exceptionConditionColumn">
          Condition
         </th>
        </tr>
        <tr>
         <td>
          <a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">
           Autodesk.Revit.Exceptions
           ArgumentException
          </a>
         </td>
         <td>
          Given element Id is not of a valid dimension element.
   -or-
   Dimension with the Id of dimensionId cannot be labeled by this global parameter.
   Possible causes include the dimension cannot be labeled at all, or it is a dimension
   of other than Linear or Angular type, or the Dimension object does not have the
   appropriate labeling parameter.
         </td>
        </tr>
        <tr>
         <td>
          <a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">
           Autodesk.Revit.Exceptions
           ArgumentNullException
          </a>
         </td>
         <td>
          A non-optional argument was NULL
         </td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
    <h1 class="heading">
     See Also
     <a name="seeAlsoToggle">
     </a>
    </h1>
    <div class="section" id="seeAlsoSection" name="collapseableSection" style="">
     <div class="seeAlsoStyle">
      <a href="b0e53a4a-84ad-abb4-358d-9797870f101b.htm">
       GlobalParameter Class
      </a>
     </div>
     <div class="seeAlsoStyle">
      <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">
       Autodesk.Revit.DB Namespace
      </a>
     </div>
    </div>
   </div>
  </div>
 </div>
</div>