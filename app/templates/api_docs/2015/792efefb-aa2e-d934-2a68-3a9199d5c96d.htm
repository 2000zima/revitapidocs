<div class="chm_content">
 <div id="header">
  <table cellpadding="0" cellspacing="0" id="topTable">
   <tbody>
    <tr>
     <td>
      <span>
      </span>
     </td>
    </tr>
   </tbody>
  </table>
  <table cellpadding="0" cellspacing="0" id="bottomTable">
   <tbody>
    <tr id="headerTableRow3">
     <td align="left">
      <a href="37fe86a0-0668-5908-9966-dfac0e0c1fe3.htm">
       IExternalService Interface
      </a>
      <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">
       SeeÂ Also
      </a>
     </td>
    </tr>
   </tbody>
  </table>
 </div>
 <div id="mainSection">
  <div id="mainBody">
   <div class="saveHistory">
    <span style="color: DarkGray">
    </span>
    <div class="summary">
     Implement this method to handle situations when servers for the service have changed.
    </div>
    <p>
     <b>
      Namespace:
     </b>
     <a href="a88f2d1d-c02f-a901-9543-44e4b5dd5fc9.htm">
      Autodesk.Revit.DB.ExternalService
     </a>
     <br/>
     <b>
      Assembly:
     </b>
     <span sdata="assembly">
      RevitAPI
     </span>
     (in RevitAPI.dll) Version: 2015.0.0.0 (2015.0.0.0)
     <br/>
     <b>
      Since:
     </b>
     2013
    </p>
    <h1 class="heading">
     Syntax
    </h1>
    <div class="section" id="syntaxSection" name="collapseableSection" style="">
     <div class="code" id="syntaxCodeBlocks">
      <span codelanguage="CSharp">
       <table>
        <tbody>
         <tr>
          <th>
           C#
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">void</span> <span class="identifier">OnServersChanged</span>(
	<a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document</a> <span class="parameter">document</span>,
	<a href="02016116-f6cf-5d3a-94df-811ef76bdebc.htm">ServerChangeCause</a> <span class="parameter">cause</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/5y536ey6" target="_blank">IList</a>&lt;<a href="http://msdn2.microsoft.com/en-us/library/cey1zx63" target="_blank">Guid</a>&gt; <span class="parameter">oldServers</span>
)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
      <span codelanguage="VisualBasicDeclaration">
       <table>
        <tbody>
         <tr>
          <th>
           Visual Basic
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">Sub</span> <span class="identifier">OnServersChanged</span> ( _
	<span class="parameter">document</span> <span class="keyword">As</span> <a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document</a>, _
	<span class="parameter">cause</span> <span class="keyword">As</span> <a href="02016116-f6cf-5d3a-94df-811ef76bdebc.htm">ServerChangeCause</a>, _
	<span class="parameter">oldServers</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/5y536ey6" target="_blank">IList</a>(<span class="keyword">Of</span> <a href="http://msdn2.microsoft.com/en-us/library/cey1zx63" target="_blank">Guid</a>) _
)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
      <span codelanguage="ManagedCPlusPlus">
       <table>
        <tbody>
         <tr>
          <th>
           Visual C++
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">void</span> <span class="identifier">OnServersChanged</span>(
	<a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document</a>^ <span class="parameter">document</span>, 
	<a href="02016116-f6cf-5d3a-94df-811ef76bdebc.htm">ServerChangeCause</a> <span class="parameter">cause</span>, 
	<a href="http://msdn2.microsoft.com/en-us/library/5y536ey6" target="_blank">IList</a>&lt;<a href="http://msdn2.microsoft.com/en-us/library/cey1zx63" target="_blank">Guid</a>&gt;^ <span class="parameter">oldServers</span>
)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
     </div>
     <div id="parameters">
      <h4 class="subHeading">
       Parameters
      </h4>
      <dl paramname="document">
       <dt>
        <span class="parameter">
         document
        </span>
       </dt>
       <dd>
        Type:
        <a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">
         Autodesk.Revit.DB
         Document
        </a>
        <br/>
        The corresponding document
       </dd>
      </dl>
      <dl paramname="cause">
       <dt>
        <span class="parameter">
         cause
        </span>
       </dt>
       <dd>
        Type:
        <a href="02016116-f6cf-5d3a-94df-811ef76bdebc.htm">
         Autodesk.Revit.DB.ExternalService
         ServerChangeCause
        </a>
        <br/>
        Indicates in what situation the servers are changed. Currently available values indicate
   whether the change is a result of an explicit user request, or by an implicit change of
   situation within the service - for example when a document is updated upon opening.
       </dd>
      </dl>
      <dl paramname="oldServers">
       <dt>
        <span class="parameter">
         oldServers
        </span>
       </dt>
       <dd>
        Type:
        <a href="http://msdn2.microsoft.com/en-us/library/5y536ey6" target="_blank">
         System.Collections.Generic
         IList
        </a>
        <a href="http://msdn2.microsoft.com/en-us/library/cey1zx63" target="_blank">
         Guid
        </a>
        <br/>
        Ids of servers previously used in the document. Please note that the Ids may
   belong to servers that are not registered with service anymore.
       </dd>
      </dl>
     </div>
    </div>
    <h1 class="heading">
     Remarks
    </h1>
    <div class="section" id="remarksSection" name="collapseableSection" style="">
     <p>
      This method may only be invoked in a recordable service.
   Services registered as non-recordable never receive this call.
     </p>
     <p>
      It is imperative to understand this method is not called just when an active server (or servers)
   is (are) changed for a service. It is invoked only when the active server is changed so it is
   different from those previously used (i.e. actually executed) in a document. Because of that,
   this notification is never sent when active server is set or reset in a document in which the
   service was never executed before.
     </p>
     If a document has explicitly set active server (or servers), OnServersChanged is never called
   for that document when the application-wide active server (servers) gets changed. The document
   would still be executed with its own active servers applied.
   A similar case is when the active server (servers) is unset for a document but the currently
   active application-wide server happens to be the same as the one that was set in the document.
     <p>
      It is up to the service provider to decide what should be the appropriate action. In some cases,
   if not all, the service will probably want to execute again, now with the new active server(s),
   but that it is not necessary - the service invoker may as well decide to wait for the end-user
   to trigger execution if the service (e.g. by clicking a corresponding command in the menu.)
     </p>
    </div>
    <h1 class="heading">
     See Also
    </h1>
    <div class="section" id="seeAlsoSection" name="collapseableSection" style="">
     <div class="seeAlsoStyle">
      <a href="37fe86a0-0668-5908-9966-dfac0e0c1fe3.htm">
       IExternalService Interface
      </a>
     </div>
     <div class="seeAlsoStyle">
      <a href="a88f2d1d-c02f-a901-9543-44e4b5dd5fc9.htm">
       Autodesk.Revit.DB.ExternalService Namespace
      </a>
     </div>
    </div>
   </div>
  </div>
 </div>
</div>