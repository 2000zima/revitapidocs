<div class="chm_content">
 <div id="header">
  <table id="bottomTable">
   <tbody>
    <tr id="headerTableRow3">
     <td align="left">
      <a href="ec25e291-6582-7e8c-f273-efc0c391bcc4.htm">
       WorksharingDisplaySettings Class
      </a>
      <a href="#exampleToggle" >
       Example
      </a>
      <a href="#seeAlsoToggle" >
       SeeÂ Also
      </a>
     </td>
    </tr>
   </tbody>
  </table>
 </div>
 <div id="mainSection">
  <div id="mainBody">
   <div class="saveHistory">
    <span style="color: DarkGray">
    </span>
    <div class="summary">
     Removes users from the list of displayed users and permanently discards any customization of the graphics.
   Note that a user cannot be removed if he or she owns any elements.
    </div>
    <p>
     <b>
      Namespace:
     </b>
     <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">
      Autodesk.Revit.DB
     </a>
     <br/>
     <b>
      Assembly:
     </b>
     <span sdata="assembly">
      RevitAPI
     </span>
     (in RevitAPI.dll) Version: 2015.0.0.0 (2015.0.0.0)
     <br/>
     <b>
      Since:
     </b>
     2012
    </p>
    <h1 class="heading">
     Syntax
     <a name="syntaxToggle">
     </a>
    </h1>
    <div class="section" id="syntaxSection" name="collapseableSection" style="">
     <div class="code" id="syntaxCodeBlocks">
      <span codelanguage="CSharp">
       <table>
        <tbody>
         <tr>
          <th>
           C#
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">public</span> <span class="keyword">void</span> <span class="identifier">RemoveUsers</span>(
	<a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document</a> <span class="parameter">document</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/92t2ye13" target="_blank">ICollection</a>&lt;<a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">string</a>&gt; <span class="parameter">usersToRemove</span>,
	<span class="keyword">out</span> <a href="http://msdn2.microsoft.com/en-us/library/92t2ye13" target="_blank">ICollection</a>&lt;<a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">string</a>&gt; <span class="parameter">usersActuallyRemoved</span>
)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
      <span codelanguage="VisualBasicDeclaration">
       <table>
        <tbody>
         <tr>
          <th>
           Visual Basic
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">Public</span> <span class="keyword">Sub</span> <span class="identifier">RemoveUsers</span> ( _
	<span class="parameter">document</span> <span class="keyword">As</span> <a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document</a>, _
	<span class="parameter">usersToRemove</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/92t2ye13" target="_blank">ICollection</a>(<span class="keyword">Of</span> <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">String</a>), _
	&lt;<a href="http://msdn2.microsoft.com/en-us/library/k8189tfc" target="_blank">OutAttribute</a>&gt; <span class="keyword">ByRef</span> <span class="parameter">usersActuallyRemoved</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/92t2ye13" target="_blank">ICollection</a>(<span class="keyword">Of</span> <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">String</a>) _
)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
      <span codelanguage="ManagedCPlusPlus">
       <table>
        <tbody>
         <tr>
          <th>
           Visual C++
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">public</span>:
<span class="keyword">void</span> <span class="identifier">RemoveUsers</span>(
	<a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document</a>^ <span class="parameter">document</span>, 
	<a href="http://msdn2.microsoft.com/en-us/library/92t2ye13" target="_blank">ICollection</a>&lt;<a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">String</a>^&gt;^ <span class="parameter">usersToRemove</span>, 
	[<a href="http://msdn2.microsoft.com/en-us/library/k8189tfc" target="_blank">OutAttribute</a>] <a href="http://msdn2.microsoft.com/en-us/library/92t2ye13" target="_blank">ICollection</a>&lt;<a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">String</a>^&gt;^% <span class="parameter">usersActuallyRemoved</span>
)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
     </div>
     <div id="parameters">
      <h4 class="subHeading">
       Parameters
      </h4>
      <dl paramname="document">
       <dt>
        <span class="parameter">
         document
        </span>
       </dt>
       <dd>
        Type:
        <a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">
         Autodesk.Revit.DB
         Document
        </a>
        <br/>
        The document containing this.
       </dd>
      </dl>
      <dl paramname="usersToRemove">
       <dt>
        <span class="parameter">
         usersToRemove
        </span>
       </dt>
       <dd>
        Type:
        <a href="http://msdn2.microsoft.com/en-us/library/92t2ye13" target="_blank">
         System.Collections.Generic
         ICollection
        </a>
        <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">
         String
        </a>
        <br/>
        The usernames of the users to remove.
       </dd>
      </dl>
      <dl paramname="usersActuallyRemoved">
       <dt>
        <span class="parameter">
         usersActuallyRemoved
        </span>
       </dt>
       <dd>
        Type:
        <a href="http://msdn2.microsoft.com/en-us/library/92t2ye13" target="_blank">
         System.Collections.Generic
         ICollection
        </a>
        <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">
         String
        </a>
        <span class="cpp">
         %
        </span>
        <br/>
        The users that were successfully removed.  Note that you cannot remove
   users who currently own any elements.
       </dd>
      </dl>
     </div>
    </div>
    <h1 class="heading">
     Remarks
     <a name="remarksToggle">
     </a>
    </h1>
    <div class="section" id="remarksSection" name="collapseableSection" style="">
     Note that default graphic overrides will be applied to any elements owned by these
   users if they take ownership of any elements or worksets while they are removed.
   Note also that the list of removed users will be shared by all users of the central model and
   will remove all customizations by all users.
    </div>
    <h1 class="heading">
     Examples
     <a name="exampleToggle">
     </a>
    </h1>
    <div class="section" id="exampleSection" name="collapseableSection" style="">
     <span codelanguage="CSharp" id="cbc_1" x-lang="CSharp">
      <div class="highlight-title">
       <span class="highlight-copycode" tabindex="0">
        <img src='{{ url_for("static", filename="img/chm/icons/CopyCode.gif") }}' style="margin-right: 5px;"/>
        Copy
       </span>
       C#
      </div>
      <div class="code">
       <pre><code><span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> RemoveAndRestoreUsers(Document doc)
{
    <span class="highlight-comment">// get or create a WorksharingDisplaySettings current active document</span>
    WorksharingDisplaySettings displaySettings = WorksharingDisplaySettings.GetOrCreateWorksharingDisplaySettings(doc);

    <span class="highlight-comment">// get all users with GraphicOverrides</span>
    ICollection&lt;String&gt; users = displaySettings.GetAllUsersWithGraphicOverrides();

    <span class="highlight-comment">// remove the users from the display settings (they will not have graphic overrides anymore)</span>
    ICollection&lt;String&gt; outUserList;
    displaySettings.RemoveUsers(doc, users, <span class="highlight-keyword">out</span> outUserList);

    <span class="highlight-comment">// show the current list of removed users</span>
    ICollection&lt;String&gt; removedUsers = displaySettings.GetRemovedUsers();

    String message = <span class="highlight-literal">"Current list of removed users: "</span>;
    <span class="highlight-keyword">if</span> (removedUsers.Count &gt; <span class="highlight-number">0</span> )
    {
       <span class="highlight-keyword">foreach</span> (String user <span class="highlight-keyword">in</span> removedUsers)
       {
          message += <span class="highlight-literal">"\n"</span> + user;
       }
    }
    <span class="highlight-keyword">else</span>
    {
        message = <span class="highlight-literal">"[Empty]"</span>;
    }

    TaskDialog.Show(<span class="highlight-literal">"Users Removed"</span>, message);

    <span class="highlight-comment">// restore the previously removed users</span>
    <span class="highlight-keyword">int</span> number = displaySettings.RestoreUsers(outUserList);

    <span class="highlight-comment">// again, show the current list of removed users</span>
    <span class="highlight-comment">// it should not contain the users that were restored</span>
    removedUsers = displaySettings.GetRemovedUsers();

    message = <span class="highlight-literal">"Current list of removed users: "</span>;
    <span class="highlight-keyword">if</span> (removedUsers.Count &gt; <span class="highlight-number">0</span> )
    {
       <span class="highlight-keyword">foreach</span> (String user <span class="highlight-keyword">in</span> removedUsers)
       {
          message += <span class="highlight-literal">"\n"</span> + user;
       }
    }
    <span class="highlight-keyword">else</span>
    {
        message = <span class="highlight-literal">"[Empty]"</span>;
    }

    TaskDialog.Show(<span class="highlight-literal">"Removed Users Restored"</span>, message);
}</code></pre>
      </div>
     </span>
     <span codelanguage="VisualBasic" id="cbc_2" x-lang="VisualBasic">
      <div class="highlight-title">
       <span class="highlight-copycode" tabindex="0">
        <img src='{{ url_for("static", filename="img/chm/icons/CopyCode.gif") }}' style="margin-right: 5px;"/>
        Copy
       </span>
       VB.NET
      </div>
      <div class="code">
       <pre><code><span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> RemoveAndRestoreUsers(doc <span class="highlight-keyword">As</span> Document)
    <span class="highlight-comment">' get or create a WorksharingDisplaySettings current active document</span>
    <span class="highlight-keyword">Dim</span> displaySettings <span class="highlight-keyword">As</span> WorksharingDisplaySettings = WorksharingDisplaySettings.GetOrCreateWorksharingDisplaySettings(doc)

    <span class="highlight-comment">' get all users with GraphicOverrides</span>
    <span class="highlight-keyword">Dim</span> users <span class="highlight-keyword">As</span> ICollection(<span class="highlight-keyword">Of</span> [<span class="highlight-keyword">String</span>]) = displaySettings.GetAllUsersWithGraphicOverrides()

    <span class="highlight-comment">' remove the users from the display settings (they will not have graphic overrides anymore)</span>
    <span class="highlight-keyword">Dim</span> outUserList <span class="highlight-keyword">As</span> ICollection(<span class="highlight-keyword">Of</span> [<span class="highlight-keyword">String</span>]) = <span class="highlight-keyword">Nothing</span>
    displaySettings.RemoveUsers(doc, users, outUserList)

    <span class="highlight-comment">' show the current list of removed users</span>
    <span class="highlight-keyword">Dim</span> removedUsers <span class="highlight-keyword">As</span> ICollection(<span class="highlight-keyword">Of</span> [<span class="highlight-keyword">String</span>]) = displaySettings.GetRemovedUsers()

    <span class="highlight-keyword">Dim</span> message <span class="highlight-keyword">As</span> [<span class="highlight-keyword">String</span>] = <span class="highlight-literal">"Current list of removed users: "</span>
    <span class="highlight-keyword">If</span> removedUsers.Count &gt; <span class="highlight-number">0</span> <span class="highlight-keyword">Then</span>
        <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> user <span class="highlight-keyword">As</span> [<span class="highlight-keyword">String</span>] <span class="highlight-keyword">In</span> removedUsers
            message += vbLf &amp; user
        <span class="highlight-keyword">Next</span>
    <span class="highlight-keyword">Else</span>
        message = <span class="highlight-literal">"[Empty]"</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

    TaskDialog.Show(<span class="highlight-literal">"Users Removed"</span>, message)

    <span class="highlight-comment">' restore the previously removed users</span>
    <span class="highlight-keyword">Dim</span> number <span class="highlight-keyword">As</span> <span class="highlight-keyword">Integer</span> = displaySettings.RestoreUsers(outUserList)

    <span class="highlight-comment">' again, show the current list of removed users</span>
    <span class="highlight-comment">' it should not contain the users that were restored</span>
    removedUsers = displaySettings.GetRemovedUsers()

    message = <span class="highlight-literal">"Current list of removed users: "</span>
    <span class="highlight-keyword">If</span> removedUsers.Count &gt; <span class="highlight-number">0</span> <span class="highlight-keyword">Then</span>
        <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> user <span class="highlight-keyword">As</span> [<span class="highlight-keyword">String</span>] <span class="highlight-keyword">In</span> removedUsers
            message += vbLf &amp; user
        <span class="highlight-keyword">Next</span>
    <span class="highlight-keyword">Else</span>
        message = <span class="highlight-literal">"[Empty]"</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

    TaskDialog.Show(<span class="highlight-literal">"Removed Users Restored"</span>, message)
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></code></pre>
      </div>
     </span>
    </div>
    <h1 class="heading">
     Exceptions
     <a name="exceptionsToggle">
     </a>
    </h1>
    <div class="section" id="exceptionsSection" name="collapseableSection" style="">
     <div class="tableSection">
      <table frame="lhs" width="100%">
       <tbody>
        <tr>
         <th class="exceptionNameColumn">
          Exception
         </th>
         <th class="exceptionConditionColumn">
          Condition
         </th>
        </tr>
        <tr>
         <td>
          <a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">
           Autodesk.Revit.Exceptions
           ArgumentNullException
          </a>
         </td>
         <td>
          A non-optional argument was NULL
         </td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
    <h1 class="heading">
     See Also
     <a name="seeAlsoToggle">
     </a>
    </h1>
    <div class="section" id="seeAlsoSection" name="collapseableSection" style="">
     <div class="seeAlsoStyle">
      <a href="ec25e291-6582-7e8c-f273-efc0c391bcc4.htm">
       WorksharingDisplaySettings Class
      </a>
     </div>
     <div class="seeAlsoStyle">
      <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">
       Autodesk.Revit.DB Namespace
      </a>
     </div>
    </div>
   </div>
  </div>
 </div>
</div>