<div class="chm_content">
 <div id="header">
  <table id="bottomTable">
   <tbody>
    <tr id="headerTableRow3">
     <td align="left">
      <a href="31b73d46-7d67-5dbb-4dad-80aa597c9afc.htm">
       Selection Class
      </a>
      <a href="#exampleToggle" >
       Example
      </a>
      <a href="#seeAlsoToggle" >
       SeeÂ Also
      </a>
     </td>
    </tr>
   </tbody>
  </table>
 </div>
 <div id="mainSection">
  <div id="mainBody">
   <div class="saveHistory">
    <span style="color: DarkGray">
    </span>
    <div class="summary">
     Prompts the user to select multiple objects which pass a custom filter while showing a custom status prompt string.
    </div>
    <p>
     <b>
      Namespace:
     </b>
     <a href="11785869-cc9e-03fc-97db-767a59af10a1.htm">
      Autodesk.Revit.UI.Selection
     </a>
     <br/>
     <b>
      Assembly:
     </b>
     <span sdata="assembly">
      RevitAPIUI
     </span>
     (in RevitAPIUI.dll) Version: 2015.0.0.0 (2015.0.0.0)
    </p>
    <h1 class="heading">
     Syntax
     <a name="syntaxToggle">
     </a>
    </h1>
    <div class="section" id="syntaxSection" name="collapseableSection" style="">
     <div class="code" id="syntaxCodeBlocks">
      <span codelanguage="CSharp">
       <table>
        <tbody>
         <tr>
          <th>
           C#
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">public</span> <a href="http://msdn2.microsoft.com/en-us/library/5y536ey6" target="_blank">IList</a>&lt;<a href="d28155ae-817b-1f31-9c3f-c9c6a28acc0d.htm">Reference</a>&gt; <span class="identifier">PickObjects</span>(
	<a href="2d0cbbba-d4ab-84b7-b081-36c14769d82c.htm">ObjectType</a> <span class="parameter">objectType</span>,
	<a href="d552f44b-221c-0ecd-d001-41a5099b2f9f.htm">ISelectionFilter</a> <span class="parameter">selectionFilter</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">string</a> <span class="parameter">statusPrompt</span>
)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
      <span codelanguage="VisualBasicDeclaration">
       <table>
        <tbody>
         <tr>
          <th>
           Visual Basic
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">PickObjects</span> ( _
	<span class="parameter">objectType</span> <span class="keyword">As</span> <a href="2d0cbbba-d4ab-84b7-b081-36c14769d82c.htm">ObjectType</a>, _
	<span class="parameter">selectionFilter</span> <span class="keyword">As</span> <a href="d552f44b-221c-0ecd-d001-41a5099b2f9f.htm">ISelectionFilter</a>, _
	<span class="parameter">statusPrompt</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">String</a> _
) <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/5y536ey6" target="_blank">IList</a>(<span class="keyword">Of</span> <a href="d28155ae-817b-1f31-9c3f-c9c6a28acc0d.htm">Reference</a>)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
      <span codelanguage="ManagedCPlusPlus">
       <table>
        <tbody>
         <tr>
          <th>
           Visual C++
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">public</span>:
<a href="http://msdn2.microsoft.com/en-us/library/5y536ey6" target="_blank">IList</a>&lt;<a href="d28155ae-817b-1f31-9c3f-c9c6a28acc0d.htm">Reference</a>^&gt;^ <span class="identifier">PickObjects</span>(
	<a href="2d0cbbba-d4ab-84b7-b081-36c14769d82c.htm">ObjectType</a> <span class="parameter">objectType</span>, 
	<a href="d552f44b-221c-0ecd-d001-41a5099b2f9f.htm">ISelectionFilter</a>^ <span class="parameter">selectionFilter</span>, 
	<a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">String</a>^ <span class="parameter">statusPrompt</span>
)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
     </div>
     <div id="parameters">
      <h4 class="subHeading">
       Parameters
      </h4>
      <dl paramname="objectType">
       <dt>
        <span class="parameter">
         objectType
        </span>
       </dt>
       <dd>
        Type:
        <a href="2d0cbbba-d4ab-84b7-b081-36c14769d82c.htm">
         Autodesk.Revit.UI.Selection
         ObjectType
        </a>
        <br/>
        Specifies the type of object to be selected.
       </dd>
      </dl>
      <dl paramname="selectionFilter">
       <dt>
        <span class="parameter">
         selectionFilter
        </span>
       </dt>
       <dd>
        Type:
        <a href="d552f44b-221c-0ecd-d001-41a5099b2f9f.htm">
         Autodesk.Revit.UI.Selection
         ISelectionFilter
        </a>
        <br/>
        The selection filter.
       </dd>
      </dl>
      <dl paramname="statusPrompt">
       <dt>
        <span class="parameter">
         statusPrompt
        </span>
       </dt>
       <dd>
        Type:
        <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">
         System
         String
        </a>
        <br/>
        The message shown on the status bar.
       </dd>
      </dl>
     </div>
     <h4 class="subHeading">
      Return Value
     </h4>
     <p>
      A collection of references selected by the user.
     </p>
     <p>
      Note: if the user cancels the operation (for example, through ESC), the method will throw an OperationCanceledException instance.
     </p>
    </div>
    <h1 class="heading">
     Remarks
     <a name="remarksToggle">
     </a>
    </h1>
    <div class="section" id="remarksSection" name="collapseableSection" style="">
     <p>
      The user will be shown "Finish" and "Cancel" buttons on the dialog bar to complete the selection operation. 
Uncheck the "Multiple" check-box to select single object and it will return the selected object directly.
     </p>
     <p>
      Revit users will be permitted to manipulate the Revit view (zooming, panning, and rotating the view), 
but will not be permitted to click other items in the Revit user interface. 
Users are not permitted to switch the active view, close the active document or Revit application in the pick session, otherwise an exception will be thrown.
     </p>
     <p>
      The selection will not be automatically added to the active selection buffer.
     </p>
     <p>
      Note: this method must not be called during dynamic update, otherwise ForbiddenForDynamicUpdateException will be thrown.
     </p>
    </div>
    <h1 class="heading">
     Examples
     <a name="exampleToggle">
     </a>
    </h1>
    <div class="section" id="exampleSection" name="collapseableSection" style="">
     <span codelanguage="CSharp" id="cbc_1" x-lang="CSharp">
      <div class="highlight-title">
       <span class="highlight-copycode" tabindex="0">
        <img src='{{ url_for("static", filename="img/chm/icons/CopyCode.gif") }}' style="margin-right: 5px;"/>
        Copy
       </span>
       C#
      </div>
      <div class="code">
       <pre><code><span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> SelectPlanarFaces(Autodesk.Revit.DB.Document document)
{
    UIDocument uidoc = <span class="highlight-keyword">new</span> UIDocument(document);
    ISelectionFilter selFilter = <span class="highlight-keyword">new</span> PlanarFacesSelectionFilter(document);
    IList&lt;Reference&gt; faces = uidoc.Selection.PickObjects(ObjectType.Face, selFilter, <span class="highlight-literal">"Select multiple planar faces"</span>);
}

<span class="highlight-keyword">public</span> <span class="highlight-keyword">class</span> PlanarFacesSelectionFilter : ISelectionFilter
{
    Document doc = <span class="highlight-keyword">null</span>;
    <span class="highlight-keyword">public</span> PlanarFacesSelectionFilter(Document document)
    {
        doc = document;
    }

    <span class="highlight-keyword">public</span> <span class="highlight-keyword">bool</span> AllowElement(Element element)
    {
        <span class="highlight-keyword">return</span> <span class="highlight-keyword">true</span>;
    }

    <span class="highlight-keyword">public</span> <span class="highlight-keyword">bool</span> AllowReference(Reference refer, XYZ point)
    {   
        <span class="highlight-keyword">if</span> (doc.GetElement(refer).GetGeometryObjectFromReference(refer) <span class="highlight-keyword">is</span> PlanarFace)
        {
            <span class="highlight-keyword">return</span> <span class="highlight-keyword">true</span>; <span class="highlight-comment">// Only return true for planar faces. Non-planar faces will not be selectable</span>
        }
        <span class="highlight-keyword">return</span> <span class="highlight-keyword">false</span>;
    }
}</code></pre>
      </div>
     </span>
     <span codelanguage="VisualBasic" id="cbc_2" x-lang="VisualBasic">
      <div class="highlight-title">
       <span class="highlight-copycode" tabindex="0">
        <img src='{{ url_for("static", filename="img/chm/icons/CopyCode.gif") }}' style="margin-right: 5px;"/>
        Copy
       </span>
       VB.NET
      </div>
      <div class="code">
       <pre><code><span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> SelectPlanarFaces(document <span class="highlight-keyword">As</span> Autodesk.Revit.DB.Document)
    <span class="highlight-keyword">Dim</span> uidoc <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> UIDocument(document)
    <span class="highlight-keyword">Dim</span> selFilter <span class="highlight-keyword">As</span> ISelectionFilter = <span class="highlight-keyword">New</span> PlanarFacesSelectionFilter(document)
    <span class="highlight-keyword">Dim</span> faces <span class="highlight-keyword">As</span> IList(<span class="highlight-keyword">Of</span> Reference) = uidoc.Selection.PickObjects(ObjectType.Face, selFilter, <span class="highlight-literal">"Select multiple planar faces"</span>)
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span>

<span class="highlight-keyword">Public</span> <span class="highlight-keyword">Class</span> PlanarFacesSelectionFilter
    <span class="highlight-keyword">Implements</span> ISelectionFilter
    <span class="highlight-keyword">Private</span> doc <span class="highlight-keyword">As</span> Document = <span class="highlight-keyword">Nothing</span>
    <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> <span class="highlight-keyword">New</span>(document <span class="highlight-keyword">As</span> Document)
        doc = document
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span>

    <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Function</span> AllowElement(element <span class="highlight-keyword">As</span> Element) <span class="highlight-keyword">As</span> <span class="highlight-keyword">Boolean</span> <span class="highlight-keyword">Implements</span> ISelectionFilter.AllowElement
        <span class="highlight-keyword">Return</span> <span class="highlight-keyword">True</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span>

    <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Function</span> AllowReference(refer <span class="highlight-keyword">As</span> Reference, point <span class="highlight-keyword">As</span> XYZ) <span class="highlight-keyword">As</span> <span class="highlight-keyword">Boolean</span> <span class="highlight-keyword">Implements</span> ISelectionFilter.AllowReference
        <span class="highlight-keyword">If</span> <span class="highlight-keyword">TypeOf</span> doc.GetElement(refer).GetGeometryObjectFromReference(refer) <span class="highlight-keyword">Is</span> PlanarFace <span class="highlight-keyword">Then</span>
            <span class="highlight-comment">' Only return true for planar faces. Non-planar faces will not be selectable</span>
            <span class="highlight-keyword">Return</span> <span class="highlight-keyword">True</span>
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
        <span class="highlight-keyword">Return</span> <span class="highlight-keyword">False</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Class</span></code></pre>
      </div>
     </span>
    </div>
    <h1 class="heading">
     Exceptions
     <a name="exceptionsToggle">
     </a>
    </h1>
    <div class="section" id="exceptionsSection" name="collapseableSection" style="">
     <div class="tableSection">
      <table frame="lhs" width="100%">
       <tbody>
        <tr>
         <th class="exceptionNameColumn">
          Exception
         </th>
         <th class="exceptionConditionColumn">
          Condition
         </th>
        </tr>
        <tr>
         <td>
          <a href="60f148c9-ece0-a6bb-4e12-bb4a9c8c8a24.htm">
           Autodesk.Revit.Exceptions
           ArgumentOutOfRangeException
          </a>
         </td>
         <td>
          Thrown when the objectType is not a recognized value.
         </td>
        </tr>
        <tr>
         <td>
          <a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">
           Autodesk.Revit.Exceptions
           ArgumentNullException
          </a>
         </td>
         <td>
          Thrown when the selectionFilter is
          <span class="keyword">
          </span>
          <span class="nu">
           a null reference (
           <span class="keyword">
            Nothing
           </span>
           in Visual Basic)
          </span>
          or statusPrompt is
          <span class="keyword">
          </span>
          <span class="nu">
           a null reference (
           <span class="keyword">
            Nothing
           </span>
           in Visual Basic)
          </span>
          .
         </td>
        </tr>
        <tr>
         <td>
          <a href="aea34480-ceb5-b49f-129d-0799e7bb1c21.htm">
           Autodesk.Revit.Exceptions
           OperationCanceledException
          </a>
         </td>
         <td>
          Thrown when the Revit user cancelled this operation. 
Thrown when the Revit user tried to switch the active view, close the active document or Revit application when responding to this mode.
         </td>
        </tr>
        <tr>
         <td>
          <a href="c5b911f6-1e8f-2cd4-6965-286f41221fe0.htm">
           Autodesk.Revit.Exceptions
           ForbiddenForDynamicUpdateException
          </a>
         </td>
         <td>
          Thrown if this method is called during dynamic update.
         </td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
    <h1 class="heading">
     See Also
     <a name="seeAlsoToggle">
     </a>
    </h1>
    <div class="section" id="seeAlsoSection" name="collapseableSection" style="">
     <div class="seeAlsoStyle">
      <a href="31b73d46-7d67-5dbb-4dad-80aa597c9afc.htm">
       Selection Class
      </a>
     </div>
     <div class="seeAlsoStyle">
      <a href="e5a547a2-3cf5-7638-2daa-ea85b4d3de2d.htm">
       PickObjects Overload
      </a>
     </div>
     <div class="seeAlsoStyle">
      <a href="11785869-cc9e-03fc-97db-767a59af10a1.htm">
       Autodesk.Revit.UI.Selection Namespace
      </a>
     </div>
    </div>
   </div>
  </div>
 </div>
</div>