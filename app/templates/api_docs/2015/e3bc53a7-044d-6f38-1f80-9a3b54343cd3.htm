<article id="api-content">
 <div id="header">
  <table id="bottomTable">
   <tbody>
    <tr id="headerTableRow3">
     <td align="left">
      <a href="ab1718f9-45fb-b3d3-827e-32ff81cf929c.htm">
       Document Class
      </a>
      <a href="#exampleToggle" >
       Example
      </a>
      <a href="#seeAlsoToggle" >
       SeeÂ Also
      </a>
     </td>
    </tr>
   </tbody>
  </table>
 </div>
 <div id="mainSection">
  <div id="mainBody">
   <div class="saveHistory">
    <span style="color: DarkGray">
    </span>
    <div class="summary">
     Creates a new instance of a LoadCombination element 
    within the project.
    </div>
    <p>
     <b>
      Namespace:
     </b>
     <a href="ded320da-058a-4edd-0418-0582389559a7.htm">
      Autodesk.Revit.Creation
     </a>
     <br/>
     <b>
      Assembly:
     </b>
     <span sdata="assembly">
      RevitAPI
     </span>
     (in RevitAPI.dll) Version: 2015.0.0.0 (2015.0.0.0)
    </p>
    <h1 class="heading">
     Syntax
     <a name="syntaxToggle">
     </a>
    </h1>
    <div class="section" id="syntaxSection" name="collapseableSection" style="">
     <div class="code" id="syntaxCodeBlocks">
      <span codelanguage="CSharp">
       <table>
        <tbody>
         <tr>
          <th>
           C#
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">public</span> <a href="82891124-6fb9-e612-ca8c-6f4e32e2c121.htm">LoadCombination</a> <span class="identifier">NewLoadCombination</span>(
	<a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">string</a> <span class="parameter">name</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">int</a> <span class="parameter">typeInd</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">int</a> <span class="parameter">stateInd</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">double</a>[] <span class="parameter">factors</span>,
	<a href="b956962a-5802-cca1-e806-cc0461fac741.htm">LoadCaseArray</a> <span class="parameter">cases</span>,
	<a href="9b91a4ed-1074-6266-97f3-dc1bd947915b.htm">LoadCombinationArray</a> <span class="parameter">combinations</span>,
	<a href="ab43e3d6-14e6-0e8c-0d55-ef3c44351ff9.htm">LoadUsageArray</a> <span class="parameter">usages</span>
)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
      <span codelanguage="VisualBasicDeclaration">
       <table>
        <tbody>
         <tr>
          <th>
           Visual Basic
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">NewLoadCombination</span> ( _
	<span class="parameter">name</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">String</a>, _
	<span class="parameter">typeInd</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">Integer</a>, _
	<span class="parameter">stateInd</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">Integer</a>, _
	<span class="parameter">factors</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">Double</a>(), _
	<span class="parameter">cases</span> <span class="keyword">As</span> <a href="b956962a-5802-cca1-e806-cc0461fac741.htm">LoadCaseArray</a>, _
	<span class="parameter">combinations</span> <span class="keyword">As</span> <a href="9b91a4ed-1074-6266-97f3-dc1bd947915b.htm">LoadCombinationArray</a>, _
	<span class="parameter">usages</span> <span class="keyword">As</span> <a href="ab43e3d6-14e6-0e8c-0d55-ef3c44351ff9.htm">LoadUsageArray</a> _
) <span class="keyword">As</span> <a href="82891124-6fb9-e612-ca8c-6f4e32e2c121.htm">LoadCombination</a></code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
      <span codelanguage="ManagedCPlusPlus">
       <table>
        <tbody>
         <tr>
          <th>
           Visual C++
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">public</span>:
<a href="82891124-6fb9-e612-ca8c-6f4e32e2c121.htm">LoadCombination</a>^ <span class="identifier">NewLoadCombination</span>(
	<a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">String</a>^ <span class="parameter">name</span>, 
	<a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">int</a> <span class="parameter">typeInd</span>, 
	<a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">int</a> <span class="parameter">stateInd</span>, 
	<span class="keyword">array</span>&lt;<a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">double</a>&gt;^ <span class="parameter">factors</span>, 
	<a href="b956962a-5802-cca1-e806-cc0461fac741.htm">LoadCaseArray</a>^ <span class="parameter">cases</span>, 
	<a href="9b91a4ed-1074-6266-97f3-dc1bd947915b.htm">LoadCombinationArray</a>^ <span class="parameter">combinations</span>, 
	<a href="ab43e3d6-14e6-0e8c-0d55-ef3c44351ff9.htm">LoadUsageArray</a>^ <span class="parameter">usages</span>
)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
     </div>
     <div id="parameters">
      <h4 class="subHeading">
       Parameters
      </h4>
      <dl paramname="name">
       <dt>
        <span class="parameter">
         name
        </span>
       </dt>
       <dd>
        Type:
        <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">
         System
         String
        </a>
        <br/>
        The not empty name for the Load Combination Element to create.
       </dd>
      </dl>
      <dl paramname="typeInd">
       <dt>
        <span class="parameter">
         typeInd
        </span>
       </dt>
       <dd>
        Type:
        <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">
         System
         Int32
        </a>
        <br/>
        LoadCombination Type Index: 0-Combination, 1-Envelope.
       </dd>
      </dl>
      <dl paramname="stateInd">
       <dt>
        <span class="parameter">
         stateInd
        </span>
       </dt>
       <dd>
        Type:
        <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">
         System
         Int32
        </a>
        <br/>
        LoadCombination State Index: 0-Servicebility, 1-Ultimate.
       </dd>
      </dl>
      <dl paramname="factors">
       <dt>
        <span class="parameter">
         factors
        </span>
       </dt>
       <dd>
        Type:
        <a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">
         System
         Double
        </a>
        <br/>
        Factors array for Load Combination formula.
       </dd>
      </dl>
      <dl paramname="cases">
       <dt>
        <span class="parameter">
         cases
        </span>
       </dt>
       <dd>
        Type:
        <a href="b956962a-5802-cca1-e806-cc0461fac741.htm">
         Autodesk.Revit.DB.Structure
         LoadCaseArray
        </a>
        <br/>
        Load Cases array for Load Combination formula.
       </dd>
      </dl>
      <dl paramname="combinations">
       <dt>
        <span class="parameter">
         combinations
        </span>
       </dt>
       <dd>
        Type:
        <a href="9b91a4ed-1074-6266-97f3-dc1bd947915b.htm">
         Autodesk.Revit.DB.Structure
         LoadCombinationArray
        </a>
        <br/>
        Load Combinations array for Load Combination formula.
       </dd>
      </dl>
      <dl paramname="usages">
       <dt>
        <span class="parameter">
         usages
        </span>
       </dt>
       <dd>
        Type:
        <a href="ab43e3d6-14e6-0e8c-0d55-ef3c44351ff9.htm">
         Autodesk.Revit.DB.Structure
         LoadUsageArray
        </a>
        <br/>
        Load Usages array.
       </dd>
      </dl>
     </div>
     <h4 class="subHeading">
      Return Value
     </h4>
     If successful, NewLoadCombination and there isn't the Load Combination Element 
    with the same name returns an object for the newly created LoadCombination. 
    If such element exist and match desired one (has the same formula and the same
    usages set), returns existing element. Otherwise
     <span class="keyword">
     </span>
     <span class="nu">
      a null reference (
      <span class="keyword">
       Nothing
      </span>
      in Visual Basic)
     </span>
     is returned.
    </div>
    <h1 class="heading">
     Remarks
     <a name="remarksToggle">
     </a>
    </h1>
    <div class="section" id="remarksSection" name="collapseableSection" style="">
     Factors and Load Combinations arrays have the same dimension (n). 
    The Load Combination formula is equal to:
    factors[0]*cases[0]*factors[1]*cases[1]*. . . factors[n]*cases[n].
    </div>
    <h1 class="heading">
     Examples
     <a name="exampleToggle">
     </a>
    </h1>
    <div class="section" id="exampleSection" name="collapseableSection" style="">
     <span codelanguage="CSharp" id="cbc_1" x-lang="CSharp">
      <div class="highlight-title">
       <span class="highlight-copycode" tabindex="0">
        <img src='{{ url_for("static", filename="img/chm/icons/CopyCode.gif") }}' style="margin-right: 5px;"/>
        Copy
       </span>
       C#
      </div>
      <div class="code">
       <pre><code>LoadCombination CreateLoadCombination(Autodesk.Revit.DB.Document document, LoadCaseArray loadCases, LoadUsageArray loadUsages)
{
    <span class="highlight-comment">// Create the factor array for load combination creation</span>
    <span class="highlight-keyword">double</span>[] factorArray = <span class="highlight-keyword">new</span> <span class="highlight-keyword">double</span>[loadCases.Size];
    <span class="highlight-keyword">for</span> (<span class="highlight-keyword">int</span> ii = <span class="highlight-number">0</span>; ii &lt; loadCases.Size; ii++)
    {
        factorArray[ii] = ii + <span class="highlight-number">1</span>;
    }

    <span class="highlight-comment">// Create a new load combination</span>
    <span class="highlight-keyword">int</span> typeInd = <span class="highlight-number">0</span>;    <span class="highlight-comment">// Combination</span>
    <span class="highlight-keyword">int</span> stateInd = <span class="highlight-number">0</span>;   <span class="highlight-comment">// Servicebility</span>
    LoadCombinationArray combinations = <span class="highlight-keyword">new</span> LoadCombinationArray();

    LoadCombination loadCombination = document.Create.NewLoadCombination(<span class="highlight-literal">"New combination"</span>,
                                                        typeInd, stateInd, factorArray, loadCases, 
                                                        combinations, loadUsages);
    <span class="highlight-keyword">if</span> (<span class="highlight-keyword">null</span> == loadCombination)
    {
        <span class="highlight-keyword">throw</span> <span class="highlight-keyword">new</span> Exception(<span class="highlight-literal">"Create a load combination failed."</span>);
    }

    <span class="highlight-comment">// Give the user some information</span>
    TaskDialog.Show(<span class="highlight-literal">"Revit"</span>,<span class="highlight-literal">"Load combination created successfully."</span>);

    <span class="highlight-keyword">return</span> loadCombination;
}</code></pre>
      </div>
     </span>
     <span codelanguage="VisualBasic" id="cbc_2" x-lang="VisualBasic">
      <div class="highlight-title">
       <span class="highlight-copycode" tabindex="0">
        <img src='{{ url_for("static", filename="img/chm/icons/CopyCode.gif") }}' style="margin-right: 5px;"/>
        Copy
       </span>
       VB.NET
      </div>
      <div class="code">
       <pre><code><span class="highlight-keyword">Private</span> <span class="highlight-keyword">Function</span> CreateLoadCombination(document <span class="highlight-keyword">As</span> Autodesk.Revit.DB.Document, loadCases <span class="highlight-keyword">As</span> LoadCaseArray, loadUsages <span class="highlight-keyword">As</span> LoadUsageArray) <span class="highlight-keyword">As</span> LoadCombination
    <span class="highlight-comment">' Create the factor array for load combination creation</span>
    <span class="highlight-keyword">Dim</span> factorArray <span class="highlight-keyword">As</span> <span class="highlight-keyword">Double</span>() = <span class="highlight-keyword">New</span> <span class="highlight-keyword">Double</span>(loadCases.Size - <span class="highlight-number">1</span>) {}
    <span class="highlight-keyword">For</span> ii <span class="highlight-keyword">As</span> <span class="highlight-keyword">Integer</span> = <span class="highlight-number">0</span> <span class="highlight-keyword">To</span> loadCases.Size - <span class="highlight-number">1</span>
        factorArray(ii) = ii + <span class="highlight-number">1</span>
    <span class="highlight-keyword">Next</span>

    <span class="highlight-comment">' Create a new load combination</span>
    <span class="highlight-keyword">Dim</span> typeInd <span class="highlight-keyword">As</span> <span class="highlight-keyword">Integer</span> = <span class="highlight-number">0</span>
    <span class="highlight-comment">' Combination</span>
    <span class="highlight-keyword">Dim</span> stateInd <span class="highlight-keyword">As</span> <span class="highlight-keyword">Integer</span> = <span class="highlight-number">0</span>
    <span class="highlight-comment">' Servicebility</span>
    <span class="highlight-keyword">Dim</span> combinations <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> LoadCombinationArray()

    <span class="highlight-keyword">Dim</span> loadCombination <span class="highlight-keyword">As</span> LoadCombination = document.Create.NewLoadCombination(<span class="highlight-literal">"New combination"</span>, typeInd, stateInd, factorArray, loadCases, combinations, _
        loadUsages)
    <span class="highlight-keyword">If</span> loadCombination <span class="highlight-keyword">Is</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
        <span class="highlight-keyword">Throw</span> <span class="highlight-keyword">New</span> Exception(<span class="highlight-literal">"Create a load combination failed."</span>)
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

    <span class="highlight-comment">' Give the user some information</span>
    TaskDialog.Show(<span class="highlight-literal">"Revit"</span>, <span class="highlight-literal">"Load combination created successfully."</span>)

    <span class="highlight-keyword">Return</span> loadCombination
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span></code></pre>
      </div>
     </span>
    </div>
    <h1 class="heading">
     Exceptions
     <a name="exceptionsToggle">
     </a>
    </h1>
    <div class="section" id="exceptionsSection" name="collapseableSection" style="">
     <div class="tableSection">
      <table frame="lhs" width="100%">
       <tbody>
        <tr>
         <th class="exceptionNameColumn">
          Exception
         </th>
         <th class="exceptionConditionColumn">
          Condition
         </th>
        </tr>
        <tr>
         <td>
          <a href="9e715f03-3884-e539-4dd6-8d7545733adc.htm">
           Autodesk.Revit.Exceptions
           InvalidOperationException
          </a>
         </td>
         <td>
          If the product is not Revit Structure.
         </td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
    <h1 class="heading">
     See Also
     <a name="seeAlsoToggle">
     </a>
    </h1>
    <div class="section" id="seeAlsoSection" name="collapseableSection" style="">
     <div class="seeAlsoStyle">
      <a href="ab1718f9-45fb-b3d3-827e-32ff81cf929c.htm">
       Document Class
      </a>
     </div>
     <div class="seeAlsoStyle">
      <a href="ded320da-058a-4edd-0418-0582389559a7.htm">
       Autodesk.Revit.Creation Namespace
      </a>
     </div>
    </div>
   </div>
  </div>
 </div>
</article>