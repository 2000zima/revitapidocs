<article id="api-content">
 <div id="header">
  <table id="bottomTable">
   <tbody>
    <tr id="headerTableRow3">
     <td align="left">
      <a href="a7622967-1381-c17f-ed04-1ebe40da0440.htm">
       FamilyItemFactory Class
      </a>
      <a href="#exampleToggle" >
       Example
      </a>
      <a href="#seeAlsoToggle" >
       SeeÂ Also
      </a>
     </td>
    </tr>
   </tbody>
  </table>
 </div>
 <div id="mainSection">
  <div id="mainBody">
   <div class="saveHistory">
    <span style="color: DarkGray">
    </span>
    <div class="summary">
     Add a new Extrusion instance into the Autodesk Revit family document.
    </div>
    <p>
     <b>
      Namespace:
     </b>
     <a href="ded320da-058a-4edd-0418-0582389559a7.htm">
      Autodesk.Revit.Creation
     </a>
     <br/>
     <b>
      Assembly:
     </b>
     <span sdata="assembly">
      RevitAPI
     </span>
     (in RevitAPI.dll) Version: 2015.0.0.0 (2015.0.0.0)
    </p>
    <h1 class="heading">
     Syntax
     <a name="syntaxToggle">
     </a>
    </h1>
    <div class="section" id="syntaxSection" name="collapseableSection" style="">
     <div class="code" id="syntaxCodeBlocks">
      <span codelanguage="CSharp">
       <table>
        <tbody>
         <tr>
          <th>
           C#
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">public</span> <a href="1d8cca8f-0ef5-0cb6-a33b-f044b968cd89.htm">Extrusion</a> <span class="identifier">NewExtrusion</span>(
	<a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">bool</a> <span class="parameter">isSolid</span>,
	<a href="c9d071fe-9724-42ed-e280-57381cd44301.htm">CurveArrArray</a> <span class="parameter">profile</span>,
	<a href="ba104029-d175-7e75-caef-667a4281f4af.htm">SketchPlane</a> <span class="parameter">sketchPlane</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">double</a> <span class="parameter">end</span>
)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
      <span codelanguage="VisualBasicDeclaration">
       <table>
        <tbody>
         <tr>
          <th>
           Visual Basic
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">NewExtrusion</span> ( _
	<span class="parameter">isSolid</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">Boolean</a>, _
	<span class="parameter">profile</span> <span class="keyword">As</span> <a href="c9d071fe-9724-42ed-e280-57381cd44301.htm">CurveArrArray</a>, _
	<span class="parameter">sketchPlane</span> <span class="keyword">As</span> <a href="ba104029-d175-7e75-caef-667a4281f4af.htm">SketchPlane</a>, _
	<span class="parameter">end</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">Double</a> _
) <span class="keyword">As</span> <a href="1d8cca8f-0ef5-0cb6-a33b-f044b968cd89.htm">Extrusion</a></code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
      <span codelanguage="ManagedCPlusPlus">
       <table>
        <tbody>
         <tr>
          <th>
           Visual C++
          </th>
         </tr>
         <tr>
          <td>
           <pre><code><span class="keyword">public</span>:
<a href="1d8cca8f-0ef5-0cb6-a33b-f044b968cd89.htm">Extrusion</a>^ <span class="identifier">NewExtrusion</span>(
	<a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">bool</a> <span class="parameter">isSolid</span>, 
	<a href="c9d071fe-9724-42ed-e280-57381cd44301.htm">CurveArrArray</a>^ <span class="parameter">profile</span>, 
	<a href="ba104029-d175-7e75-caef-667a4281f4af.htm">SketchPlane</a>^ <span class="parameter">sketchPlane</span>, 
	<a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">double</a> <span class="parameter">end</span>
)</code></pre>
          </td>
         </tr>
        </tbody>
       </table>
      </span>
     </div>
     <div id="parameters">
      <h4 class="subHeading">
       Parameters
      </h4>
      <dl paramname="isSolid">
       <dt>
        <span class="parameter">
         isSolid
        </span>
       </dt>
       <dd>
        Type:
        <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">
         System
         Boolean
        </a>
        <br/>
        Indicates if the Extrusion is Solid or Void.
       </dd>
      </dl>
      <dl paramname="profile">
       <dt>
        <span class="parameter">
         profile
        </span>
       </dt>
       <dd>
        Type:
        <a href="c9d071fe-9724-42ed-e280-57381cd44301.htm">
         Autodesk.Revit.DB
         CurveArrArray
        </a>
        <br/>
        The profile of the newly created Extrusion. This may contain more 
than one curve loop. Each loop must be a fully closed curve loop and the loops may not 
intersect. All input curves must lie in the same plane.
The loop can be a unbound circle or ellipse,  but its geometry will be split in two in 
order to satisfy requirements for sketches used in extrusions.
       </dd>
      </dl>
      <dl paramname="sketchPlane">
       <dt>
        <span class="parameter">
         sketchPlane
        </span>
       </dt>
       <dd>
        Type:
        <a href="ba104029-d175-7e75-caef-667a4281f4af.htm">
         Autodesk.Revit.DB
         SketchPlane
        </a>
        <br/>
        The sketch plane for the extrusion.  The direction of extrusion
is determined by the normal for the sketch plane.  To extrude in the other direction set 
the end value to negative.
       </dd>
      </dl>
      <dl paramname="end">
       <dt>
        <span class="parameter">
         end
        </span>
       </dt>
       <dd>
        Type:
        <a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">
         System
         Double
        </a>
        <br/>
        The length of the extrusion.
       </dd>
      </dl>
     </div>
     <h4 class="subHeading">
      Return Value
     </h4>
     If creation was successful the new Extrusion is returned, 
otherwise an exception with failure information will be thrown.
    </div>
    <h1 class="heading">
     Remarks
     <a name="remarksToggle">
     </a>
    </h1>
    <div class="section" id="remarksSection" name="collapseableSection" style="">
     This method creates an extrusion in a family document. The extrusion will be 
extended perpendicular to the sketch plane of the extrusion profile.
    </div>
    <h1 class="heading">
     Examples
     <a name="exampleToggle">
     </a>
    </h1>
    <div class="section" id="exampleSection" name="collapseableSection" style="">
     <span codelanguage="CSharp" id="cbc_1" x-lang="CSharp">
      <div class="highlight-title">
       <span class="highlight-copycode" tabindex="0">
        <img src='{{ url_for("static", filename="img/chm/icons/CopyCode.gif") }}' style="margin-right: 5px;"/>
        Copy
       </span>
       C#
      </div>
      <div class="code">
       <pre><code><span class="highlight-keyword">private</span> Extrusion CreateExtrusion(Autodesk.Revit.DB.Document document, SketchPlane sketchPlane)
{
    Extrusion rectExtrusion = <span class="highlight-keyword">null</span>;

    <span class="highlight-comment">// make sure we have a family document</span>
    <span class="highlight-keyword">if</span> (<span class="highlight-keyword">true</span> == document.IsFamilyDocument)
    {
        <span class="highlight-comment">// define the profile for the extrusion</span>
        CurveArrArray curveArrArray = <span class="highlight-keyword">new</span> CurveArrArray();
        CurveArray curveArray1 = <span class="highlight-keyword">new</span> CurveArray();
        CurveArray curveArray2 = <span class="highlight-keyword">new</span> CurveArray();
        CurveArray curveArray3 = <span class="highlight-keyword">new</span> CurveArray();

        <span class="highlight-comment">// create a rectangular profile</span>
        XYZ p0 = XYZ.Zero;
        XYZ p1 = <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">10</span>, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>);
        XYZ p2 = <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">10</span>, <span class="highlight-number">10</span>, <span class="highlight-number">0</span>);
        XYZ p3 = <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">0</span>, <span class="highlight-number">10</span>, <span class="highlight-number">0</span>);
        Line line1 = Line.CreateBound(p0, p1);
        Line line2 = Line.CreateBound(p1, p2);
        Line line3 = Line.CreateBound(p2, p3);
        Line line4 = Line.CreateBound(p3, p0);
        curveArray1.Append(line1);
        curveArray1.Append(line2);
        curveArray1.Append(line3);
        curveArray1.Append(line4);

        curveArrArray.Append(curveArray1);

        <span class="highlight-comment">// create solid rectangular extrusion</span>
        rectExtrusion = document.FamilyCreate.NewExtrusion(<span class="highlight-keyword">true</span>, curveArrArray, sketchPlane, <span class="highlight-number">10</span>);

        <span class="highlight-keyword">if</span> (<span class="highlight-keyword">null</span> != rectExtrusion)
        {
            <span class="highlight-comment">// move extrusion to proper place</span>
            XYZ transPoint1 = <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">-16</span>, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>);
            ElementTransformUtils.MoveElement(document, rectExtrusion.Id, transPoint1);
        }
        <span class="highlight-keyword">else</span>
        {
            <span class="highlight-keyword">throw</span> <span class="highlight-keyword">new</span> Exception(<span class="highlight-literal">"Create new Extrusion failed."</span>);
        }
    }
    <span class="highlight-keyword">else</span>
    {
        <span class="highlight-keyword">throw</span> <span class="highlight-keyword">new</span> Exception(<span class="highlight-literal">"Please open a Family document before invoking this command."</span>);
    }

    <span class="highlight-keyword">return</span> rectExtrusion;
}</code></pre>
      </div>
     </span>
     <span codelanguage="VisualBasic" id="cbc_2" x-lang="VisualBasic">
      <div class="highlight-title">
       <span class="highlight-copycode" tabindex="0">
        <img src='{{ url_for("static", filename="img/chm/icons/CopyCode.gif") }}' style="margin-right: 5px;"/>
        Copy
       </span>
       VB.NET
      </div>
      <div class="code">
       <pre><code><span class="highlight-keyword">Private</span> <span class="highlight-keyword">Function</span> CreateExtrusion(document <span class="highlight-keyword">As</span> Autodesk.Revit.DB.Document, sketchPlane <span class="highlight-keyword">As</span> SketchPlane) <span class="highlight-keyword">As</span> Extrusion
    <span class="highlight-keyword">Dim</span> rectExtrusion <span class="highlight-keyword">As</span> Extrusion = <span class="highlight-keyword">Nothing</span>

    <span class="highlight-comment">' make sure we have a family document</span>
    <span class="highlight-keyword">If</span> <span class="highlight-keyword">True</span> = document.IsFamilyDocument <span class="highlight-keyword">Then</span>
        <span class="highlight-comment">' define the profile for the extrusion</span>
        <span class="highlight-keyword">Dim</span> curveArrArray <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> CurveArrArray()
        <span class="highlight-keyword">Dim</span> curveArray1 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> CurveArray()
        <span class="highlight-keyword">Dim</span> curveArray2 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> CurveArray()
        <span class="highlight-keyword">Dim</span> curveArray3 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> CurveArray()

        <span class="highlight-comment">' create a rectangular profile</span>
        <span class="highlight-keyword">Dim</span> p0 <span class="highlight-keyword">As</span> XYZ = XYZ.Zero
        <span class="highlight-keyword">Dim</span> p1 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">10</span>, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>)
        <span class="highlight-keyword">Dim</span> p2 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">10</span>, <span class="highlight-number">10</span>, <span class="highlight-number">0</span>)
        <span class="highlight-keyword">Dim</span> p3 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">0</span>, <span class="highlight-number">10</span>, <span class="highlight-number">0</span>)
        <span class="highlight-keyword">Dim</span> line1 <span class="highlight-keyword">As</span> Line = Line.CreateBound(p0, p1)
        <span class="highlight-keyword">Dim</span> line2 <span class="highlight-keyword">As</span> Line = Line.CreateBound(p1, p2)
        <span class="highlight-keyword">Dim</span> line3 <span class="highlight-keyword">As</span> Line = Line.CreateBound(p2, p3)
        <span class="highlight-keyword">Dim</span> line4 <span class="highlight-keyword">As</span> Line = Line.CreateBound(p3, p0)
        curveArray1.Append(line1)
        curveArray1.Append(line2)
        curveArray1.Append(line3)
        curveArray1.Append(line4)

        curveArrArray.Append(curveArray1)

        <span class="highlight-comment">' create solid rectangular extrusion</span>
        rectExtrusion = document.FamilyCreate.NewExtrusion(<span class="highlight-keyword">True</span>, curveArrArray, sketchPlane, <span class="highlight-number">10</span>)

        <span class="highlight-keyword">If</span> rectExtrusion <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
            <span class="highlight-comment">' move extrusion to proper place</span>
            <span class="highlight-keyword">Dim</span> transPoint1 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">-16</span>, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>)
            ElementTransformUtils.MoveElement(document, rectExtrusion.Id, transPoint1)
        <span class="highlight-keyword">Else</span>
            <span class="highlight-keyword">Throw</span> <span class="highlight-keyword">New</span> Exception(<span class="highlight-literal">"Create new Extrusion failed."</span>)
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
    <span class="highlight-keyword">Else</span>
        <span class="highlight-keyword">Throw</span> <span class="highlight-keyword">New</span> Exception(<span class="highlight-literal">"Please open a Family document before invoking this command."</span>)
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

    <span class="highlight-keyword">Return</span> rectExtrusion
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span></code></pre>
      </div>
     </span>
    </div>
    <h1 class="heading">
     Exceptions
     <a name="exceptionsToggle">
     </a>
    </h1>
    <div class="section" id="exceptionsSection" name="collapseableSection" style="">
     <div class="tableSection">
      <table frame="lhs" width="100%">
       <tbody>
        <tr>
         <th class="exceptionNameColumn">
          Exception
         </th>
         <th class="exceptionConditionColumn">
          Condition
         </th>
        </tr>
        <tr>
         <td>
          <a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">
           Autodesk.Revit.Exceptions
           ArgumentException
          </a>
         </td>
         <td>
          Thrown when the input argument-profile-is
          <span class="keyword">
          </span>
          <span class="nu">
           a null reference (
           <span class="keyword">
            Nothing
           </span>
           in Visual Basic)
          </span>
          or empty array.
         </td>
        </tr>
        <tr>
         <td>
          <a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">
           Autodesk.Revit.Exceptions
           ArgumentNullException
          </a>
         </td>
         <td>
          Thrown when the input argument-sketchPlane-is
          <span class="keyword">
          </span>
          <span class="nu">
           a null reference (
           <span class="keyword">
            Nothing
           </span>
           in Visual Basic)
          </span>
          .
         </td>
        </tr>
        <tr>
         <td>
          <a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">
           Autodesk.Revit.Exceptions
           ArgumentException
          </a>
         </td>
         <td>
          Thrown when the input argument-sketchPlane-is an invalid sketch plane.
         </td>
        </tr>
        <tr>
         <td>
          <a href="9e715f03-3884-e539-4dd6-8d7545733adc.htm">
           Autodesk.Revit.Exceptions
           InvalidOperationException
          </a>
         </td>
         <td>
          Thrown when the creation failed.
         </td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
    <h1 class="heading">
     See Also
     <a name="seeAlsoToggle">
     </a>
    </h1>
    <div class="section" id="seeAlsoSection" name="collapseableSection" style="">
     <div class="seeAlsoStyle">
      <a href="a7622967-1381-c17f-ed04-1ebe40da0440.htm">
       FamilyItemFactory Class
      </a>
     </div>
     <div class="seeAlsoStyle">
      <a href="ded320da-058a-4edd-0418-0582389559a7.htm">
       Autodesk.Revit.Creation Namespace
      </a>
     </div>
    </div>
   </div>
  </div>
 </div>
</article>