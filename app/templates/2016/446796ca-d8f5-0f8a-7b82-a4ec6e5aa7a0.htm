{% macro header() %}<title>FailuresProcessing Event</title>{% assets "css_chm" %}<link rel="stylesheet" type="text/css" href="{{ ASSET_URL }}" />{% endassets %}{% assets "js_chm" %}<script src="{{ ASSET_URL }}"></script>{% endassets %}<meta name="container" content="Autodesk.Revit.ApplicationServices" /><meta name="file" content="446796ca-d8f5-0f8a-7b82-a4ec6e5aa7a0" /><meta name="guid" content="446796ca-d8f5-0f8a-7b82-a4ec6e5aa7a0" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script>{% endmacro %}<div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit 2016 API</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Application<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>FailuresProcessing Event</span></td></tr><tr id="headerTableRow3"><td align="left"><a href="94db8ea8-d2c3-5e71-8030-466bcb8e4426.htm">Application Class</a> <a href="#exampleToggle" onclick="OpenSection(exampleToggle)">Example</a> <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> <span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('revitapifeedback@autodesk.com','Revit 2016 API','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></table></div><div id="mainSection"><div id="mainBody"><div class="summary">
   Subscribe to the FailuresProcessing event to be notified when failures are being processed at the end of transaction.
</div><p /><b>Namespace:</b> <a href="91957e18-2935-006c-83ab-3b5b9dbb5928.htm">Autodesk.Revit.ApplicationServices</a><br /><b>Assembly:</b> <span sdata="assembly">RevitAPI</span> (in RevitAPI.dll) Version: 16.0.0.0 (16.0.0.0)<br /><b>Since:</b> 
   2011
<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> event <a href="http://msdn2.microsoft.com/en-us/library/db0etb8x" target="_blank">EventHandler</a>&lt;<a href="a35dc3de-c8a4-8af0-6a3c-706716e5f885.htm">FailuresProcessingEventArgs</a>&gt; <span class="identifier">FailuresProcessing</span></pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> Event <span class="identifier">FailuresProcessing</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/db0etb8x" target="_blank">EventHandler</a>(<span class="keyword">Of</span> <a href="a35dc3de-c8a4-8af0-6a3c-706716e5f885.htm">FailuresProcessingEventArgs</a>)</pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span>:
 <span class="keyword">event</span> <a href="http://msdn2.microsoft.com/en-us/library/db0etb8x" target="_blank">EventHandler</a>&lt;<a href="a35dc3de-c8a4-8af0-6a3c-706716e5f885.htm">FailuresProcessingEventArgs</a>^&gt;^ <span class="identifier">FailuresProcessing</span> {
	<span class="keyword">void</span> <span class="keyword">add</span> (<a href="http://msdn2.microsoft.com/en-us/library/db0etb8x" target="_blank">EventHandler</a>&lt;<a href="a35dc3de-c8a4-8af0-6a3c-706716e5f885.htm">FailuresProcessingEventArgs</a>^&gt;^ <span class="parameter">value</span>);
	<span class="keyword">void</span> <span class="keyword">remove</span> (<a href="http://msdn2.microsoft.com/en-us/library/db0etb8x" target="_blank">EventHandler</a>&lt;<a href="a35dc3de-c8a4-8af0-6a3c-706716e5f885.htm">FailuresProcessingEventArgs</a>^&gt;^ <span class="parameter">value</span>);
}</pre></td></tr></table></span></div></div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style=""><p>This event is raised when failures are being processed during transaction commit or rollback operations.
   Handlers of this event have a limited ability to modify the document and/or failures in it, using the provided
   restricted failures accessor interface. </p><p>The event arguments provide access to the FailuresAccessor via
   <span class="nolink">[!:Autodesk::Revit::DB::FailuresProcessingEventArgs::GetFailuresAccessor()]</span>
   which contains the details of the errors and/or warnings that caused the event to trigger. </p><p> The arguments also allow you to set a processing result via
   <span class="nolink">[!:Autodesk::Revit::DB::FailuresProcessingEventArgs::SetProcessingResult()]</span>.  The processing
   result determines if Revit will attempt to recommit the currently failing transaction, roll it back, or continue.
   If you are explicitly dismissing warnings from the event callback, a processing result of Continue
   is sufficient.  But if you are explicitly resolving errors from the event callback, you must change the
   processing result to ProceedWithCommit to ensure that the user is not shown the dismissed errors.   If you
   wish to cancel the transaction silently without showing the errors to the user, set the processing result to
   ProceedWithRollback, however you must also call
   <a href="bebe6efd-b05f-7a0b-4cc3-609ec35be42c.htm">SetClearAfterRollback(Boolean)</a> in
   order to dismiss the errors and silently cancel the transaction.</p></div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/copycode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve">[Autodesk.Revit.Attributes.Transaction(Autodesk.Revit.Attributes.TransactionMode.Automatic)]

<span class="highlight-keyword">public</span> <span class="highlight-keyword">class</span> NoUnenclosedRoomWarnings : IExternalApplication
{
    <span class="highlight-keyword">static</span> AddInId m_appId = <span class="highlight-keyword">new</span> AddInId(<span class="highlight-keyword">new</span> Guid(<span class="highlight-literal">"EB296268-8364-4d25-96E6-F664C608503C"</span>));

    <span class="highlight-keyword">public</span> Result OnStartup(UIControlledApplication application)
    {
        <span class="highlight-comment">//Create an API application that subscribes to FailuresProcessing event for the lifetime of the session.</span>
        application.ControlledApplication.FailuresProcessing += <span class="highlight-keyword">new</span> EventHandler&lt;FailuresProcessingEventArgs&gt;(CheckWarnings);
        <span class="highlight-keyword">return</span> Result.Succeeded;
    }

    <span class="highlight-keyword">public</span> Result OnShutdown(UIControlledApplication application)
    {
        <span class="highlight-keyword">return</span> Result.Succeeded;
    }

    <span class="highlight-keyword">private</span> <span class="highlight-keyword">void</span> CheckWarnings(<span class="highlight-keyword">object</span> sender, FailuresProcessingEventArgs e)
    {
        FailuresAccessor fa = e.GetFailuresAccessor();
        IList&lt;FailureMessageAccessor&gt; failList = <span class="highlight-keyword">new</span> List&lt;FailureMessageAccessor&gt;();
        failList = fa.GetFailureMessages(); <span class="highlight-comment">// Inside event handler, get all warnings</span>
        <span class="highlight-keyword">foreach</span> (FailureMessageAccessor failure <span class="highlight-keyword">in</span> failList)
        {
            <span class="highlight-comment">// check FailureDefinitionIds against ones that you want to dismiss, </span>
            FailureDefinitionId failID = failure.GetFailureDefinitionId();
            <span class="highlight-comment">// prevent Revit from showing Unenclosed room warnings</span>
            <span class="highlight-keyword">if</span> (failID == BuiltInFailures.RoomFailures.RoomNotEnclosed)
            {
                fa.DeleteWarning(failure);
            }
        }
    }
}</pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/copycode.gif" />Copy</span>VB.NET</div><div class="code"><pre xml:space="preserve">&lt;Autodesk.Revit.Attributes.Transaction(Autodesk.Revit.Attributes.TransactionMode.Automatic)&gt; _
<span class="highlight-keyword">Public</span> <span class="highlight-keyword">Class</span> NoUnenclosedRoomWarnings
    <span class="highlight-keyword">Implements</span> IExternalApplication
    <span class="highlight-keyword">Shared</span> m_appId <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> AddInId(<span class="highlight-keyword">New</span> Guid(<span class="highlight-literal">"EB296268-8364-4d25-96E6-F664C608503C"</span>))

    <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Function</span> OnStartup(application <span class="highlight-keyword">As</span> UIControlledApplication) <span class="highlight-keyword">As</span> Autodesk.Revit.UI.Result <span class="highlight-keyword">Implements</span> IExternalApplication.OnStartup
        <span class="highlight-comment">'Create an API application that subscribes to FailuresProcessing event for the lifetime of the session.</span>
        <span class="highlight-keyword">AddHandler</span> application.ControlledApplication.FailuresProcessing, <span class="highlight-keyword">AddressOf</span> CheckWarnings
        <span class="highlight-keyword">Return</span> Result.Succeeded
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span>

    <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Function</span> OnShutdown(application <span class="highlight-keyword">As</span> UIControlledApplication) <span class="highlight-keyword">As</span> Autodesk.Revit.UI.Result <span class="highlight-keyword">Implements</span> IExternalApplication.OnShutdown
        <span class="highlight-keyword">Return</span> Result.Succeeded
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span>

    <span class="highlight-keyword">Private</span> <span class="highlight-keyword">Sub</span> CheckWarnings(sender <span class="highlight-keyword">As</span> <span class="highlight-keyword">Object</span>, e <span class="highlight-keyword">As</span> FailuresProcessingEventArgs)
        <span class="highlight-keyword">Dim</span> fa <span class="highlight-keyword">As</span> FailuresAccessor = e.GetFailuresAccessor()
        <span class="highlight-keyword">Dim</span> failList <span class="highlight-keyword">As</span> IList(<span class="highlight-keyword">Of</span> FailureMessageAccessor) = <span class="highlight-keyword">New</span> List(<span class="highlight-keyword">Of</span> FailureMessageAccessor)()
        failList = fa.GetFailureMessages()
        <span class="highlight-comment">' Inside event handler, get all warnings</span>
        <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> failure <span class="highlight-keyword">As</span> FailureMessageAccessor <span class="highlight-keyword">In</span> failList
            <span class="highlight-comment">' check FailureDefinitionIds against ones that you want to dismiss, </span>
            <span class="highlight-keyword">Dim</span> failID <span class="highlight-keyword">As</span> FailureDefinitionId = failure.GetFailureDefinitionId()
            <span class="highlight-comment">' prevent Revit from showing Unenclosed room warnings</span>
            <span class="highlight-keyword">If</span> failID = BuiltInFailures.RoomFailures.RoomNotEnclosed <span class="highlight-keyword">Then</span>
                fa.DeleteWarning(failure)
            <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
        <span class="highlight-keyword">Next</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Class</span></pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="94db8ea8-d2c3-5e71-8030-466bcb8e4426.htm">Application Class</a></div><div class="seeAlsoStyle"><a href="91957e18-2935-006c-83ab-3b5b9dbb5928.htm">Autodesk.Revit.ApplicationServices Namespace</a></div></div></div></div>
