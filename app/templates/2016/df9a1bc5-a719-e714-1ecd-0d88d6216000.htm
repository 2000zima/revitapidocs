{% macro header() %}<title>AddSpatialFieldPrimitive Method (Face, Transform)</title>{% assets "css_chm" %}<link rel="stylesheet" type="text/css" href="{{ ASSET_URL }}" />{% endassets %}{% assets "js_assets" %}<script src="{{ ASSET_URL }}"></script>{% endassets %}<meta name="container" content="Autodesk.Revit.DB.Analysis" /><meta name="file" content="df9a1bc5-a719-e714-1ecd-0d88d6216000" /><meta name="guid" content="df9a1bc5-a719-e714-1ecd-0d88d6216000" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script>{% endmacro %}<div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit 2016 API</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">SpatialFieldManager<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>AddSpatialFieldPrimitive Method (Face, Transform)</span></td></tr><tr id="headerTableRow3"><td align="left"><a href="0a6d155e-6ef1-7215-f8f1-c1d8203797ee.htm">SpatialFieldManager Class</a> <a href="#exampleToggle" onclick="OpenSection(exampleToggle)">Example</a> <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> <span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('revitapifeedback@autodesk.com','Revit 2016 API','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></table></div><div id="mainSection"><div id="mainBody"><div class="summary">
   Creates empty analysis results primitive associated with a face and a transform.
</div><p /><b>Namespace:</b> <a href="958e2e12-587d-f188-5d7b-f13d7dbfdf48.htm">Autodesk.Revit.DB.Analysis</a><br /><b>Assembly:</b> <span sdata="assembly">RevitAPI</span> (in RevitAPI.dll) Version: 16.0.0.0 (16.0.0.0)<br /><b>Since:</b> 
   2011
<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">int</a> <span class="identifier">AddSpatialFieldPrimitive</span>(
	<a href="e32b3b1f-66fc-57cb-6e1c-aa81d1bf3e63.htm">Face</a> <span class="parameter">face</span>,
	<a href="58dd01c8-b3fc-7142-e4f3-c524079a282d.htm">Transform</a> <span class="parameter">trf</span>
)</pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">AddSpatialFieldPrimitive</span> ( _
	<span class="parameter">face</span> <span class="keyword">As</span> <a href="e32b3b1f-66fc-57cb-6e1c-aa81d1bf3e63.htm">Face</a>, _
	<span class="parameter">trf</span> <span class="keyword">As</span> <a href="58dd01c8-b3fc-7142-e4f3-c524079a282d.htm">Transform</a> _
) <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">Integer</a></pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span>:
<a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">int</a> <span class="identifier">AddSpatialFieldPrimitive</span>(
	<a href="e32b3b1f-66fc-57cb-6e1c-aa81d1bf3e63.htm">Face</a>^ <span class="parameter">face</span>,
	<a href="58dd01c8-b3fc-7142-e4f3-c524079a282d.htm">Transform</a>^ <span class="parameter">trf</span>
)</pre></td></tr></table></span></div><div id="parameters"><h4 class="subHeading">Parameters</h4><dl paramName="face"><dt><span class="parameter">face</span></dt><dd>Type: <a href="e32b3b1f-66fc-57cb-6e1c-aa81d1bf3e63.htm">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Face</a><br />
   Face to be associated with the primitive
</dd></dl><dl paramName="trf"><dt><span class="parameter">trf</span></dt><dd>Type: <a href="58dd01c8-b3fc-7142-e4f3-c524079a282d.htm">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Transform</a><br />
   Conformal Transform to be applied to %face%
</dd></dl></div><h4 class="subHeading">Return Value</h4>
   Unique index of primitive for future references
</div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style=""><p> This method accepts a reference to a model face, and a transform to be applied to
   that face, allowing the display of analytical results on faces which are not
   strictly a part of the Revit model. </p><p>This method should not be used if the transform is the identity transform,
   i.e. the intent is to display results on a face which is part of the Revit model.
   In that case, use the overload of this method which accepts
   a reference.</p><p> If the input face is from the geometry of a symbol, the face will be considered to be
   in the location specified by its symbol geometry. If your intention is to transform the face
   relative to its location in the instance, your input transform must consist of the instance's
   transform left multiplied by the extra transform to get the results you expect.</p></div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/copycode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">// Create SpatialFieldPrimitive to display results offset from a face</span>
BoundingBoxUV bb = face.GetBoundingBox();
UV min = bb.Min;
UV max = bb.Max;

<span class="highlight-comment">// Find the face normal at the center of the face's bounding box</span>
UV faceCenter = <span class="highlight-keyword">new</span> UV((max.U + min.U) / <span class="highlight-number">2</span>, (max.V + min.V) / <span class="highlight-number">2</span>);
Transform computeDerivatives = face.ComputeDerivatives(faceCenter);
XYZ faceCenterNormal = computeDerivatives.BasisZ;

<span class="highlight-comment">// Normalize the normal vector and multiply by 2.5 </span>
XYZ faceCenterNormalMultiplied = faceCenterNormal.Normalize().Multiply(<span class="highlight-number">2.5</span>);
Transform transform = Transform.CreateTranslation(faceCenterNormalMultiplied);

<span class="highlight-comment">// Use face and transform when adding the SpatialFieldPrimitive</span>
SpatialFieldManager sfm = SpatialFieldManager.CreateSpatialFieldManager(doc.ActiveView, <span class="highlight-number">3</span>);
<span class="highlight-keyword">int</span> idx = sfm.AddSpatialFieldPrimitive(face, transform);</pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/copycode.gif" />Copy</span>VB.NET</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">' Create SpatialFieldPrimitive to display results offset from a face</span>
<span class="highlight-keyword">Dim</span> bb <span class="highlight-keyword">As</span> BoundingBoxUV = face.GetBoundingBox()
<span class="highlight-keyword">Dim</span> min <span class="highlight-keyword">As</span> UV = bb.Min
<span class="highlight-keyword">Dim</span> max <span class="highlight-keyword">As</span> UV = bb.Max

<span class="highlight-comment">' Find the face normal at the center of the face's bounding box</span>
<span class="highlight-keyword">Dim</span> faceCenter <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> UV((max.U + min.U) / <span class="highlight-number">2</span>, (max.V + min.V) / <span class="highlight-number">2</span>)
<span class="highlight-keyword">Dim</span> computeDerivatives <span class="highlight-keyword">As</span> Transform = face.ComputeDerivatives(faceCenter)
<span class="highlight-keyword">Dim</span> faceCenterNormal <span class="highlight-keyword">As</span> XYZ = computeDerivatives.BasisZ

<span class="highlight-comment">' Normalize the normal vector and multiply by 2.5 </span>
<span class="highlight-keyword">Dim</span> faceCenterNormalMultiplied <span class="highlight-keyword">As</span> XYZ = faceCenterNormal.Normalize().Multiply(<span class="highlight-number">2.5</span>)
<span class="highlight-keyword">Dim</span> transform__1 <span class="highlight-keyword">As</span> Transform = Transform.CreateTranslation(faceCenterNormalMultiplied)

<span class="highlight-comment">' Use face and transform when adding the SpatialFieldPrimitive</span>
<span class="highlight-keyword">Dim</span> sfm <span class="highlight-keyword">As</span> SpatialFieldManager = SpatialFieldManager.CreateSpatialFieldManager(doc.ActiveView, <span class="highlight-number">3</span>)
<span class="highlight-keyword">Dim</span> idx <span class="highlight-keyword">As</span> <span class="highlight-keyword">Integer</span> = sfm.AddSpatialFieldPrimitive(face, transform__1)</pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(exceptionsToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exceptionsToggle, event)" tabindex="0"><img id="exceptionsToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Exceptions</span></h1><div id="exceptionsSection" class="section" name="collapseableSection" style=""><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th class="exceptionNameColumn">Exception</th><th class="exceptionConditionColumn">Condition</th></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentNullException</a></td><td>
   A non-optional argument was NULL
</td></tr><tr><td><a href="60f148c9-ece0-a6bb-4e12-bb4a9c8c8a24.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentOutOfRangeException</a></td><td>
   trf is not conformal.
</td></tr></table></div></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="0a6d155e-6ef1-7215-f8f1-c1d8203797ee.htm">SpatialFieldManager Class</a></div><div class="seeAlsoStyle"><a href="125b85d3-9b44-c90d-2eab-7334be74117f.htm">AddSpatialFieldPrimitive Overload</a></div><div class="seeAlsoStyle"><a href="958e2e12-587d-f188-5d7b-f13d7dbfdf48.htm">Autodesk.Revit.DB.Analysis Namespace</a></div></div></div></div>
