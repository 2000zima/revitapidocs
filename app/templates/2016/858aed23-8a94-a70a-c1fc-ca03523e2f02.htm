{% macro header() %}<title>EnergyAnalysisDetailModel Class</title>{% assets "css_chm" %}<link rel="stylesheet" type="text/css" href="{{ ASSET_URL }}" />{% endassets %}{% assets "js_assets" %}<script src="{{ ASSET_URL }}"></script>{% endassets %}<meta name="container" content="Autodesk.Revit.DB.Analysis" /><meta name="file" content="858aed23-8a94-a70a-c1fc-ca03523e2f02" /><meta name="guid" content="858aed23-8a94-a70a-c1fc-ca03523e2f02" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script>{% endmacro %}<div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit 2016 API</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">EnergyAnalysisDetailModel Class</span></td></tr><tr id="headerTableRow3"><td align="left"><a href="c031cf91-0561-d129-4dcc-967a6f0a1b3f.htm">Members</a> <a href="#exampleToggle" onclick="OpenSection(exampleToggle)">Example</a> <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> <span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('revitapifeedback@autodesk.com','Revit 2016 API','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></table></div><div id="mainSection"><div id="mainBody"><div class="summary">
   Manage the analytical thermal model.
</div><p /><b>Namespace:</b> <a href="958e2e12-587d-f188-5d7b-f13d7dbfdf48.htm">Autodesk.Revit.DB.Analysis</a><br /><b>Assembly:</b> <span sdata="assembly">RevitAPI</span> (in RevitAPI.dll) Version: 16.0.0.0 (16.0.0.0)<br /><b>Since:</b> 
   2012
<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">EnergyAnalysisDetailModel</span> : <a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Element</a></pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Class</span> <span class="identifier">EnergyAnalysisDetailModel</span> _
	<span class="keyword">Inherits</span> <a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Element</a></pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">EnergyAnalysisDetailModel</span> : <span class="keyword">public</span> <a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Element</a></pre></td></tr></table></span></div></div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="">
   The Export to gbXML and the Heating and Cooling Loads features
   produces an analytical thermal model from the physical model
   of a building. The analytical thermal model is composed of
   spaces, zones and planar surfaces that represent the actual
   volumetric elements of the building.
   If there are currently no EnergyAnalysisDetailModel elements in
   the document, when the first one is generated it will be considered
   the persistent energy model (and maybe removed and recreated by
   actions the user takes in the UI). If there is already a persistent
   EnergyAnalysisDetailModel element in the document, the API can
   generate other independent energy models, but they will not be
   affected by the actions the user takes in the UI.
   The EnergyAnalysisDetailModel will remain in the document until
   it is discarded (either by the actions of the user, or by a call
   to Document.Delete() ).
</div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">// Collect space and surface data from the building's analytical thermal model</span>
EnergyAnalysisDetailModelOptions options = <span class="highlight-keyword">new</span> EnergyAnalysisDetailModelOptions();
options.Tier = EnergyAnalysisDetailModelTier.Final; <span class="highlight-comment">// include constructions, schedules, and non-graphical data in the computation of the energy analysis model</span>

EnergyAnalysisDetailModel eadm = EnergyAnalysisDetailModel.Create(doc, options); <span class="highlight-comment">// Create a new energy analysis detailed model from the physical model</span>
IList&lt;EnergyAnalysisSpace&gt; spaces = eadm.GetAnalyticalSpaces();
StringBuilder builder = <span class="highlight-keyword">new</span> StringBuilder();
builder.AppendLine(<span class="highlight-literal">"Spaces: "</span> + spaces.Count);
<span class="highlight-keyword">foreach</span> (EnergyAnalysisSpace space <span class="highlight-keyword">in</span> spaces)
{
    SpatialElement spatialElement = doc.GetElement(space.CADObjectUniqueId) <span class="highlight-keyword">as</span> SpatialElement;
    ElementId spatialElementId = spatialElement == <span class="highlight-keyword">null</span> ? ElementId.InvalidElementId : spatialElement.Id;
    builder.AppendLine(<span class="highlight-literal">"   &gt;&gt;&gt; "</span> + space.Name + <span class="highlight-literal">" related to "</span> + spatialElementId);
    IList&lt;EnergyAnalysisSurface&gt; surfaces = space.GetAnalyticalSurfaces();
    builder.AppendLine(<span class="highlight-literal">"       has "</span> + surfaces.Count + <span class="highlight-literal">" surfaces."</span>);
    <span class="highlight-keyword">foreach</span> (EnergyAnalysisSurface surface <span class="highlight-keyword">in</span> surfaces)
    {
        builder.AppendLine(<span class="highlight-literal">"            +++ Surface from "</span> + surface.OriginatingElementDescription);
    }
}
TaskDialog.Show(<span class="highlight-literal">"EAM"</span>, builder.ToString());</pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>VB.NET</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">' Collect space and surface data from the building's analytical thermal model</span>
<span class="highlight-keyword">Dim</span> options <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> EnergyAnalysisDetailModelOptions()
options.Tier = EnergyAnalysisDetailModelTier.Final
<span class="highlight-comment">' include constructions, schedules, and non-graphical data in the computation of the energy analysis model</span>
<span class="highlight-keyword">Dim</span> eadm <span class="highlight-keyword">As</span> EnergyAnalysisDetailModel = EnergyAnalysisDetailModel.Create(doc, options)
<span class="highlight-comment">' Create a new energy analysis detailed model from the physical model</span>
<span class="highlight-keyword">Dim</span> spaces <span class="highlight-keyword">As</span> IList(<span class="highlight-keyword">Of</span> EnergyAnalysisSpace) = eadm.GetAnalyticalSpaces()
<span class="highlight-keyword">Dim</span> builder <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> StringBuilder()
builder.AppendLine(<span class="highlight-literal">"Spaces: "</span> &amp; spaces.Count)
<span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> space <span class="highlight-keyword">As</span> EnergyAnalysisSpace <span class="highlight-keyword">In</span> spaces
    <span class="highlight-keyword">Dim</span> spatialElement <span class="highlight-keyword">As</span> SpatialElement = <span class="highlight-keyword">TryCast</span>(doc.GetElement(space.CADObjectUniqueId), SpatialElement)
    <span class="highlight-keyword">Dim</span> spatialElementId <span class="highlight-keyword">As</span> ElementId = <span class="highlight-keyword">If</span>(spatialElement <span class="highlight-keyword">Is</span> <span class="highlight-keyword">Nothing</span>, ElementId.InvalidElementId, spatialElement.Id)
    builder.AppendLine(<span class="highlight-literal">"   &gt;&gt;&gt; "</span> + space.Name &amp; <span class="highlight-literal">" related to "</span> &amp; spatialElementId.ToString())
    <span class="highlight-keyword">Dim</span> surfaces <span class="highlight-keyword">As</span> IList(<span class="highlight-keyword">Of</span> EnergyAnalysisSurface) = space.GetAnalyticalSurfaces()
    builder.AppendLine(<span class="highlight-literal">"       has "</span> &amp; surfaces.Count &amp; <span class="highlight-literal">" surfaces."</span>)
    <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> surface <span class="highlight-keyword">As</span> EnergyAnalysisSurface <span class="highlight-keyword">In</span> surfaces
        builder.AppendLine(<span class="highlight-literal">"            +++ Surface from "</span> + surface.OriginatingElementDescription)
    <span class="highlight-keyword">Next</span>
<span class="highlight-keyword">Next</span>
TaskDialog.Show(<span class="highlight-literal">"EAM"</span>, builder.ToString())</pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(familyToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(familyToggle, event)" tabindex="0"><img id="familyToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Inheritance Hierarchy</span></h1><div id="familySection" class="section" name="collapseableSection" style=""><a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Object</a><br />  <a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Element</a><br />    <span class="selflink">Autodesk.Revit.DB.Analysis<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>EnergyAnalysisDetailModel</span><br /></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="c031cf91-0561-d129-4dcc-967a6f0a1b3f.htm">EnergyAnalysisDetailModel Members</a></div><div class="seeAlsoStyle"><a href="958e2e12-587d-f188-5d7b-f13d7dbfdf48.htm">Autodesk.Revit.DB.Analysis Namespace</a></div></div></div></div>