{% macro header() %}<title>SunAndShadowSettings Class</title>{% assets "css_chm" %}<link rel="stylesheet" type="text/css" href="{{ ASSET_URL }}" />{% endassets %}{% assets "js_assets" %}<script src="{{ ASSET_URL }}"></script>{% endassets %}<meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="d616614b-a2ed-b0d0-4f11-f0a0b54a22e5" /><meta name="guid" content="d616614b-a2ed-b0d0-4f11-f0a0b54a22e5" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script>{% endmacro %}<div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit 2015 API</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">SunAndShadowSettings Class</span></td></tr><tr id="headerTableRow3"><td align="left"><a href="53022ab0-6e4a-2e4e-1ed8-5eb896ab4091.htm">Members</a> <a href="#exampleToggle" onclick="OpenSection(exampleToggle)">Example</a> <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> <span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('revitapifeedback@autodesk.com','Revit 2015 API','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></table></div><div id="mainSection"><div id="mainBody"><div class="summary">
   The SunAndShadowSettings class represents the sun control.
</div><p /><b>Namespace:</b> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><b>Assembly:</b> <span sdata="assembly">RevitAPI</span> (in RevitAPI.dll) Version: 2015.0.0.0 (2015.0.0.0)<br /><b>Since:</b> 
   2011
<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">SunAndShadowSettings</span> : <a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Element</a></pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Class</span> <span class="identifier">SunAndShadowSettings</span> _
	<span class="keyword">Inherits</span> <a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Element</a></pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">SunAndShadowSettings</span> : <span class="keyword">public</span> <a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Element</a></pre></td></tr></table></span></div></div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="">
   The SunAndShadowSettings element represents the settings applied to a project or view regarding
   the position, dates, time intervals and other options for the sun control and solar studies.
   To differentiate between the project and view settings, test the ViewSpecific or OwnerViewId property.
   If the element is not view-specific this element represents a project-wide setting.
   If the element is associated to a view, this element represents a per view SunAndShadowSettings.
   When you create a new view, a new view-specific SunAndShadowSettings element is automatically created
   for it.
</div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/copycode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve">SunAndShadowSettings sunSettings = view.SunAndShadowSettings; <span class="highlight-comment">// get current settings from view</span>

<span class="highlight-comment">// modify Sun and Shadow Settings</span>
DateTime sunrise = sunSettings.GetSunrise(DateTime.SpecifyKind(<span class="highlight-keyword">new</span> DateTime(<span class="highlight-number">2011</span>, <span class="highlight-number">4</span>, <span class="highlight-number">20</span>), DateTimeKind.Local)); <span class="highlight-comment">// sunrise on April 20, 2011</span>
DateTime sunset = sunSettings.GetSunset(DateTime.SpecifyKind(<span class="highlight-keyword">new</span> DateTime(<span class="highlight-number">2011</span>, <span class="highlight-number">4</span>, <span class="highlight-number">22</span>), DateTimeKind.Local)); <span class="highlight-comment">// sunset on April 22, 2011</span>
sunSettings.SunAndShadowType = SunAndShadowType.MultiDayStudy;
sunSettings.StartDateAndTime = sunrise.AddHours(<span class="highlight-number">2</span>); <span class="highlight-comment">// start 2 hours after sunrise on April 20, 2011</span>
sunSettings.EndDateAndTime = sunset.AddHours(<span class="highlight-number">-2</span>); <span class="highlight-comment">// end 2 hours before sunset on April 22, 2011</span>
<span class="highlight-keyword">if</span> (sunSettings.IsTimeIntervalValid(SunStudyTimeInterval.Hour)) <span class="highlight-comment">// check that this interval is valid for this SunAndShadowType</span>
    sunSettings.TimeInterval = SunStudyTimeInterval.Hour;

<span class="highlight-comment">// check for validity of start and end times</span>
<span class="highlight-keyword">if</span> (!(sunSettings.IsAfterStartDateAndTime(sunSettings.EndDateAndTime)
    &amp;&amp; sunSettings.IsBeforeEndDateAndTime(sunSettings.StartDateAndTime)))
    TaskDialog.Show(<span class="highlight-literal">"Error"</span>, <span class="highlight-literal">"Start and End dates are invalid"</span>);

view.get_Parameter(BuiltInParameter.VIEW_GRAPH_SUN_PATH).Set(<span class="highlight-number">1</span>); <span class="highlight-comment">// turn on display of the sun path</span></pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/copycode.gif" />Copy</span>VB.NET</div><div class="code"><pre xml:space="preserve"><span class="highlight-keyword">Dim</span> sunSettings__1 <span class="highlight-keyword">As</span> SunAndShadowSettings = view.SunAndShadowSettings
<span class="highlight-comment">' get current settings from view</span>
<span class="highlight-comment">' modify Sun and Shadow Settings</span>
<span class="highlight-keyword">Dim</span> sunrise <span class="highlight-keyword">As</span> DateTime = sunSettings__1.GetSunrise(DateTime.SpecifyKind(<span class="highlight-keyword">New</span> DateTime(<span class="highlight-number">2011</span>, <span class="highlight-number">4</span>, <span class="highlight-number">20</span>), DateTimeKind.Local))
<span class="highlight-comment">' sunrise on April 20, 2011</span>
<span class="highlight-keyword">Dim</span> sunset <span class="highlight-keyword">As</span> DateTime = sunSettings__1.GetSunset(DateTime.SpecifyKind(<span class="highlight-keyword">New</span> DateTime(<span class="highlight-number">2011</span>, <span class="highlight-number">4</span>, <span class="highlight-number">22</span>), DateTimeKind.Local))
<span class="highlight-comment">' sunset on April 22, 2011</span>
sunSettings__1.SunAndShadowType = SunAndShadowType.MultiDayStudy
sunSettings__1.StartDateAndTime = sunrise.AddHours(<span class="highlight-number">2</span>)
<span class="highlight-comment">' start 2 hours after sunrise on April 20, 2011</span>
sunSettings__1.EndDateAndTime = sunset.AddHours(<span class="highlight-number">-2</span>)
<span class="highlight-comment">' end 2 hours before sunset on April 22, 2011</span>
<span class="highlight-keyword">If</span> sunSettings__1.IsTimeIntervalValid(SunStudyTimeInterval.Hour) <span class="highlight-keyword">Then</span>
    <span class="highlight-comment">' check that this interval is valid for this SunAndShadowType</span>
    sunSettings__1.TimeInterval = SunStudyTimeInterval.Hour
<span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

<span class="highlight-comment">' check for validity of start and end times</span>
<span class="highlight-keyword">If</span> <span class="highlight-keyword">Not</span> (sunSettings__1.IsAfterStartDateAndTime(sunSettings__1.EndDateAndTime) <span class="highlight-keyword">AndAlso</span> sunSettings__1.IsBeforeEndDateAndTime(sunSettings__1.StartDateAndTime)) <span class="highlight-keyword">Then</span>
    TaskDialog.Show(<span class="highlight-literal">"Error"</span>, <span class="highlight-literal">"Start and End dates are invalid"</span>)
<span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

view.Parameter(BuiltInParameter.VIEW_GRAPH_SUN_PATH).[<span class="highlight-keyword">Set</span>](<span class="highlight-number">1</span>)
<span class="highlight-comment">' turn on display of the sun path</span></pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(familyToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(familyToggle, event)" tabindex="0"><img id="familyToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Inheritance Hierarchy</span></h1><div id="familySection" class="section" name="collapseableSection" style=""><a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Object</a><br />  <a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Element</a><br />    <span class="selflink">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>SunAndShadowSettings</span><br /></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="53022ab0-6e4a-2e4e-1ed8-5eb896ab4091.htm">SunAndShadowSettings Members</a></div><div class="seeAlsoStyle"><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div></div>
