<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Elements Property </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="Elements property" /><meta name="System.Keywords" content="Selection.Elements property" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.UI.Selection.Selection.Elements" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.UI.Selection.Selection.get_Elements" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.UI.Selection.Selection.set_Elements" /><meta name="Microsoft.Help.Id" content="P:Autodesk.Revit.UI.Selection.Selection.Elements" /><meta name="Description" content="The elements that are shown as selected in the Revit user-interface." /><meta name="Microsoft.Help.ContentType" content="Reference" /><link rel="stylesheet" type="text/css" href="../styles/Presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/Dropdown.js"> </script><script type="text/javascript" src="../scripts/script_manifold.js"> </script><script type="text/javascript" src="../scripts/script_feedBack.js"> </script><script type="text/javascript" src="../scripts/CheckboxMenu.js"> </script><script type="text/javascript" src="../scripts/CommonUtilities.js"> </script><meta name="container" content="Autodesk.Revit.UI.Selection" /><meta name="file" content="5e50856c-e3b0-9881-427c-b7195b7f3e1c" /><meta name="guid" content="5e50856c-e3b0-9881-427c-b7195b7f3e1c" /><xml><MSHelp:Attr Name="AssetID" Value="P:Autodesk.Revit.UI.Selection.Selection.Elements" /><MSHelp:TOCTitle Title="Elements Property " /><MSHelp:RLTitle Title="Selection.Elements Property  (Autodesk.Revit.UI.Selection)" /><MSHelp:Keyword Index="A" Term="P:Autodesk.Revit.UI.Selection.Selection.Elements" /><MSHelp:Keyword Index="A" Term="frlrfAutodeskRevitUISelectionSelectionClassElementsTopic" /><MSHelp:Keyword Index="K" Term="Elements property" /><MSHelp:Keyword Index="K" Term="Selection.Elements property" /><MSHelp:Keyword Index="F" Term="Autodesk.Revit.UI.Selection.Selection.Elements" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="RevitAPIUI.dll" /><MSHelp:Attr Name="APIName" Value="Autodesk.Revit.UI.Selection.Selection.Elements" /><MSHelp:Attr Name="APIName" Value="Autodesk.Revit.UI.Selection.Selection.get_Elements" /><MSHelp:Attr Name="APIName" Value="Autodesk.Revit.UI.Selection.Selection.set_Elements" /><MSHelp:Attr Name="DevLang" Value="CSharp" /><MSHelp:Attr Name="DevLang" Value="VB" /><MSHelp:Attr Name="Locale" Value="en-us" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="Abstract" Value="The elements that are shown as selected in the Revit user-interface." /><MSHelp:Attr Name="AssemblyVersion" Value="2015.0.0.0" /></xml><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script></head><body><input type="hidden" id="userDataCache" class="userDataStyle" /><input type="hidden" id="hiddenScrollOffset" /><img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" alt="Collapse image" title="Collapse image" /><img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" alt="Expand Image" title="Expand Image" /><img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" /><img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" /><img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/dropdown.gif" /><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/dropdownHover.gif" /><img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" alt="Copy image" title="Copy image" /><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" alt="CopyHover image" title="CopyHover image" /><div id="header"><table id="topTable" cellspacing="0" cellpadding="0"><tr><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img ID="toggleAllImage" class="toggleAll" src="../icons/collapse_all.gif" /> <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span><span>    </span><span id="devlangsDropdown" class="filter" tabindex="0"><img id="devlangsDropdownImage" src="../icons/dropdown.gif" /> <label id="devlangsMenuAllLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: All </nobr></label><label id="devlangsMenuMultipleLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Multiple </nobr></label><label id="devlangsMenuCSharpLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: C# </nobr></label><label id="devlangsMenuVisualBasicLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual Basic </nobr></label><label id="devlangsMenuManagedCPlusPlusLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual C++ </nobr></label></span></td></tr></table><div id="devlangsMenu"><input id="CSharpCheckbox" type="checkbox" data="CSharp,cs,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="CSharpCheckbox">C#</label><br /><input id="VisualBasicCheckbox" type="checkbox" data="VisualBasic,vb,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="VisualBasicCheckbox">Visual Basic</label><br /><input id="ManagedCPlusPlusCheckbox" type="checkbox" data="ManagedCPlusPlus,cpp,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="ManagedCPlusPlusCheckbox">Visual C++</label><br /></div><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit 2015 API</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Selection<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Elements Property </span></td></tr><tr id="headerTableRow3"><td align="left"><a href="31b73d46-7d67-5dbb-4dad-80aa597c9afc.htm">Selection Class</a> <a href="#exampleToggle" onclick="OpenSection(exampleToggle)">Example</a> <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> <span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('revitapifeedback@autodesk.com','Revit 2015 API','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" /><span style="color: DarkGray"></span><div class="summary">The elements that are shown as selected in the Revit user-interface.</div><p /><b>Namespace:</b> <a href="11785869-cc9e-03fc-97db-767a59af10a1.htm">Autodesk.Revit.UI.Selection</a><br /><b>Assembly:</b> <span sdata="assembly">RevitAPIUI</span> (in RevitAPIUI.dll) Version: 2015.0.0.0 (2015.0.0.0)<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve">[<a href="http://msdn2.microsoft.com/en-us/library/fwz0y5c2" target="_blank">ObsoleteAttribute</a>("This property is deprecated in Revit 2015. Use GetElementIds() and SetElementIds instead.")]
<span class="keyword">public</span> <a href="73b3008c-81fb-6b72-3d0d-b60d9241f1fc.htm">SelElementSet</a> <span class="identifier">Elements</span> { <span class="keyword">get</span>; <span class="keyword">set</span>; }</pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve">&lt;<a href="http://msdn2.microsoft.com/en-us/library/fwz0y5c2" target="_blank">ObsoleteAttribute</a>("This property is deprecated in Revit 2015. Use GetElementIds() and SetElementIds instead.")&gt; _
<span class="keyword">Public</span> <span class="keyword">Property</span> <span class="identifier">Elements</span> <span class="keyword">As</span> <a href="73b3008c-81fb-6b72-3d0d-b60d9241f1fc.htm">SelElementSet</a>
	<span class="keyword">Get</span>
	<span class="keyword">Set</span></pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve">[<a href="http://msdn2.microsoft.com/en-us/library/fwz0y5c2" target="_blank">ObsoleteAttribute</a>(L"This property is deprecated in Revit 2015. Use GetElementIds() and SetElementIds instead.")]
<span class="keyword">public</span>:
<span class="keyword">property</span> <a href="73b3008c-81fb-6b72-3d0d-b60d9241f1fc.htm">SelElementSet</a>^ <span class="identifier">Elements</span> {
	<a href="73b3008c-81fb-6b72-3d0d-b60d9241f1fc.htm">SelElementSet</a>^ <span class="keyword">get</span> ();
	<span class="keyword">void</span> <span class="keyword">set</span> (<a href="73b3008c-81fb-6b72-3d0d-b60d9241f1fc.htm">SelElementSet</a>^ <span class="parameter">value</span>);
}</pre></td></tr></table></span></div><h4 class="subHeading">Field Value</h4>The selected elements.</div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="">PickOne and WindowSelect add to this set because they modify the set of elements selected in the user-interface
after the External Command is complete. Selections made with PickObject, PickObjects, and PickElementsByRectangle do not
persist after the External Command is complete, and therefore they do not affect this property. </div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-keyword">private</span> <span class="highlight-keyword">void</span> ChangeSelection(UIDocument uidoc)
{
    <span class="highlight-comment">// Get selected elements from current document.</span>
    ICollection&lt;ElementId&gt; selectedIds = uidoc.Selection.GetElementIds();

    <span class="highlight-comment">// Display current number of selected elements</span>
    TaskDialog.Show(<span class="highlight-literal">"Revit"</span>, <span class="highlight-literal">"Number of selected elements: "</span> + selectedIds.Count.ToString());

    <span class="highlight-comment">// Go through the selected items and filter out walls only.</span>
    ICollection&lt;ElementId&gt; selectedWallIds = <span class="highlight-keyword">new</span> List&lt;ElementId&gt;();

    <span class="highlight-keyword">foreach</span> (ElementId id <span class="highlight-keyword">in</span> selectedIds)
    {
        Element elements = uidoc.Document.GetElement(id);
        <span class="highlight-keyword">if</span> (elements <span class="highlight-keyword">is</span> Wall)
        {
            selectedWallIds.Add(id);
        }
    }

    <span class="highlight-comment">// Set the created element set as current select element set.</span>
    uidoc.Selection.SetElementIds(selectedWallIds);

    <span class="highlight-comment">// Give the user some information.</span>
    <span class="highlight-keyword">if</span> (<span class="highlight-number">0</span> != selectedWallIds.Count)
    {
        TaskDialog.Show(<span class="highlight-literal">"Revit"</span>, selectedWallIds.Count.ToString() + <span class="highlight-literal">" Walls are selected!"</span>);
    }
    <span class="highlight-keyword">else</span>
    {
        TaskDialog.Show(<span class="highlight-literal">"Revit"</span>,<span class="highlight-literal">"No Walls have been selected!"</span>);
    }
}</pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>VB.NET</div><div class="code"><pre xml:space="preserve"><span class="highlight-keyword">Private</span> <span class="highlight-keyword">Sub</span> ChangeSelection(uidoc <span class="highlight-keyword">As</span> UIDocument)
    <span class="highlight-comment">' Get selected elements from current document.</span>
    <span class="highlight-keyword">Dim</span> selectedIds <span class="highlight-keyword">As</span> ICollection(<span class="highlight-keyword">Of</span> ElementId) = uidoc.Selection.GetElementIds()

    <span class="highlight-comment">' Display current number of selected elements</span>
    TaskDialog.Show(<span class="highlight-literal">"Revit"</span>, <span class="highlight-literal">"Number of selected elements: "</span> &amp; selectedIds.Count.ToString())

    <span class="highlight-comment">' Go through the selected items and filter out walls only.</span>
    <span class="highlight-keyword">Dim</span> selectedWallIds <span class="highlight-keyword">As</span> ICollection(<span class="highlight-keyword">Of</span> ElementId) = <span class="highlight-keyword">New</span> List(<span class="highlight-keyword">Of</span> ElementId)()

    <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> id <span class="highlight-keyword">As</span> ElementId <span class="highlight-keyword">In</span> selectedIds
        <span class="highlight-keyword">Dim</span> elements <span class="highlight-keyword">As</span> Element = uidoc.Document.GetElement(id)
        <span class="highlight-keyword">If</span> <span class="highlight-keyword">TypeOf</span> elements <span class="highlight-keyword">Is</span> Wall <span class="highlight-keyword">Then</span>
            selectedWallIds.Add(id)
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
    <span class="highlight-keyword">Next</span>

    <span class="highlight-comment">' Set the created element set as current select element set.</span>
    uidoc.Selection.SetElementIds(selectedWallIds)

    <span class="highlight-comment">' Give the user some information.</span>
    <span class="highlight-keyword">If</span> <span class="highlight-number">0</span> &lt;&gt; selectedWallIds.Count <span class="highlight-keyword">Then</span>
        TaskDialog.Show(<span class="highlight-literal">"Revit"</span>, selectedWallIds.Count.ToString() &amp; <span class="highlight-literal">" Walls are selected!"</span>)
    <span class="highlight-keyword">Else</span>
        TaskDialog.Show(<span class="highlight-literal">"Revit"</span>, <span class="highlight-literal">"No Walls have been selected!"</span>)
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="31b73d46-7d67-5dbb-4dad-80aa597c9afc.htm">Selection Class</a></div><div class="seeAlsoStyle"><a href="11785869-cc9e-03fc-97db-767a59af10a1.htm">Autodesk.Revit.UI.Selection Namespace</a></div></div></div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="../icons/footer.gif" alt="Footer image" title="Footer image" /></div><A NAME="feedback"></A><span id="fb" class="feedbackcss"></span><p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit 2015 API">Autodesk</a><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></div></body></html>