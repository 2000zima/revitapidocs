{% macro header() %}<title>RegisterService Method (IMultiServerService, ExternalServiceOptions, ExecutionPolicy)</title>{% assets "css_chm" %}<link rel="stylesheet" type="text/css" href="{{ ASSET_URL }}" />{% endassets %}{% assets "js_assets" %}<script src="{{ ASSET_URL }}"></script>{% endassets %}<meta name="container" content="Autodesk.Revit.DB.ExternalService" /><meta name="file" content="79a85e01-c0c0-9efa-0a91-271b57cdc557" /><meta name="guid" content="79a85e01-c0c0-9efa-0a91-271b57cdc557" />{% endmacro %}<div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit 2015 API</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">ExternalServiceRegistry<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>RegisterService Method (IMultiServerService, ExternalServiceOptions, ExecutionPolicy)</span></td></tr><tr id="headerTableRow3"><td align="left"><a href="fa14442f-3d47-2c21-467c-6d19e4cc0d9e.htm">ExternalServiceRegistry Class</a> <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> <span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('revitapifeedback@autodesk.com','Revit 2015 API','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></table></div><div id="mainSection"><div id="mainBody"><div class="summary">
   A method to register a multi-server service.
</div><p /><b>Namespace:</b> <a href="a88f2d1d-c02f-a901-9543-44e4b5dd5fc9.htm">Autodesk.Revit.DB.ExternalService</a><br /><b>Assembly:</b> <span sdata="assembly">RevitAPI</span> (in RevitAPI.dll) Version: 2015.0.0.0 (2015.0.0.0)<br /><b>Since:</b> 
   2014
<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <a href="http://msdn2.microsoft.com/en-us/library/cey1zx63" target="_blank">Guid</a> <span class="identifier">RegisterService</span>(
	<a href="9704c8c0-2095-37e7-f17c-56d27ff44ed6.htm">IMultiServerService</a> <span class="parameter">service</span>,
	<a href="80467d42-3f13-de3e-cd06-bf3b43afefe0.htm">ExternalServiceOptions</a> <span class="parameter">options</span>,
	<a href="5234000e-cf74-d7aa-85ff-dcfbed63434b.htm">ExecutionPolicy</a> <span class="parameter">policy</span>
)</pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">RegisterService</span> ( _
	<span class="parameter">service</span> <span class="keyword">As</span> <a href="9704c8c0-2095-37e7-f17c-56d27ff44ed6.htm">IMultiServerService</a>, _
	<span class="parameter">options</span> <span class="keyword">As</span> <a href="80467d42-3f13-de3e-cd06-bf3b43afefe0.htm">ExternalServiceOptions</a>, _
	<span class="parameter">policy</span> <span class="keyword">As</span> <a href="5234000e-cf74-d7aa-85ff-dcfbed63434b.htm">ExecutionPolicy</a> _
) <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/cey1zx63" target="_blank">Guid</a></pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">static</span> <a href="http://msdn2.microsoft.com/en-us/library/cey1zx63" target="_blank">Guid</a> <span class="identifier">RegisterService</span>(
	<a href="9704c8c0-2095-37e7-f17c-56d27ff44ed6.htm">IMultiServerService</a>^ <span class="parameter">service</span>, 
	<a href="80467d42-3f13-de3e-cd06-bf3b43afefe0.htm">ExternalServiceOptions</a>^ <span class="parameter">options</span>, 
	<a href="5234000e-cf74-d7aa-85ff-dcfbed63434b.htm">ExecutionPolicy</a> <span class="parameter">policy</span>
)</pre></td></tr></table></span></div><div id="parameters"><h4 class="subHeading">Parameters</h4><dl paramName="service"><dt><span class="parameter">service</span></dt><dd>Type: <a href="9704c8c0-2095-37e7-f17c-56d27ff44ed6.htm">Autodesk.Revit.DB.ExternalService<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>IMultiServerService</a><br />
   An instance of the external service class that implements IMultiServerService interface.
</dd></dl><dl paramName="options"><dt><span class="parameter">options</span></dt><dd>Type: <a href="80467d42-3f13-de3e-cd06-bf3b43afefe0.htm">Autodesk.Revit.DB.ExternalService<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ExternalServiceOptions</a><br />
   Optional settings to control the service's behavior.
</dd></dl><dl paramName="policy"><dt><span class="parameter">policy</span></dt><dd>Type: <a href="5234000e-cf74-d7aa-85ff-dcfbed63434b.htm">Autodesk.Revit.DB.ExternalService<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ExecutionPolicy</a><br />
   Specifies how the service handles servers during its execution.
</dd></dl></div><h4 class="subHeading">Return Value</h4>
   An execution key to access the service when executing it.
</div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style=""><p>
   Each service can only be registered once. Revit checks the Id of every service
   getting registered and throws an exception upon an attempt to register a service
   with an Id that already exists.
   </p><p>
   Services need to be registered before Revit ends its initialization.
   For external applications that means they have to register their services
   during OnStartup. This will give servers which need to register to services
   a chance to do so during the ApplicationInitialized event, which is raised
   after a successfully processing OnStartup routines.
   </p><p>
   A service can be registered as either recordable or non-recordable.
   It is expected that a service that is once registered as recordable
   will always be registered as recordable. Failure to comply with this
   policy may lead to data loss in some documents when they are opened
   in a Revit session with the service currently registered as non-recordable.
   </p><p>
   An application registering a service must specify a policy to follow when
   executing the service. Once set, the policy remain constant during the
   Revit session, but a different policy may be used next time, if there
   is ever a need for such a change. More about the various execution policies
   can be found in the description of the ExecutionPolicy enumerated type.
   </p><p>
   A service is supposed to be executed only by the application that registered
   it. To enforce this requirement, the registering method return an execution
   key (a Guid) that is required as an argument to ExecuteService methods.
   If the owner of a service allows executing it by anyone, it needs to register
   it as a public service (via the option argument). Once registered as public,
   The access key of the service can be obtained by any application, thus
   it can also be executed by any application. By default, a service is registered
   as private.
   </p></div><h1 class="heading"><span onclick="ExpandCollapse(exceptionsToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exceptionsToggle, event)" tabindex="0"><img id="exceptionsToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Exceptions</span></h1><div id="exceptionsSection" class="section" name="collapseableSection" style=""><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th class="exceptionNameColumn">Exception</th><th class="exceptionConditionColumn">Condition</th></tr><tr><td><a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentException</a></td><td>
   The given service is not a valid implementation of ISingleServerService.
   -or-
   The given service does not return valid values from the interface methods.
   At least one of the Name, VendorId, Description, and ServiceId is either empty or invalid.
   -or-
   A service with this Id is either invalid or not unique.
</td></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentNullException</a></td><td>
   A non-optional argument was NULL
</td></tr><tr><td><a href="60f148c9-ece0-a6bb-4e12-bb4a9c8c8a24.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentOutOfRangeException</a></td><td>
   A value passed for an enumeration argument is not a member of that enumeration
</td></tr><tr><td><a href="9e715f03-3884-e539-4dd6-8d7545733adc.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>InvalidOperationException</a></td><td>
   Service cannot be registered because the registry of services has been already closed.
   All external services must be registered before the ApplicationInitialized event is raised.
</td></tr></table></div></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="fa14442f-3d47-2c21-467c-6d19e4cc0d9e.htm">ExternalServiceRegistry Class</a></div><div class="seeAlsoStyle"><a href="6d690a5d-62c5-958c-842e-620a49421c1c.htm">RegisterService Overload</a></div><div class="seeAlsoStyle"><a href="a88f2d1d-c02f-a901-9543-44e4b5dd5fc9.htm">Autodesk.Revit.DB.ExternalService Namespace</a></div></div></div></div>