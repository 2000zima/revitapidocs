{% macro header() %}<title>PostFailure Method </title>{% assets "css_chm" %}<link rel="stylesheet" type="text/css" href="{{ ASSET_URL }}" />{% endassets %}{% assets "js_assets" %}<script src="{{ ASSET_URL }}"></script>{% endassets %}<meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="7184ff0a-f30e-03fb-904f-fb557df6fa37" /><meta name="guid" content="7184ff0a-f30e-03fb-904f-fb557df6fa37" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script>{% endmacro %}<div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit 2015 API</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Document<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>PostFailure Method </span></td></tr><tr id="headerTableRow3"><td align="left"><a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document Class</a> <a href="#exampleToggle" onclick="OpenSection(exampleToggle)">Example</a> <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> <span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('revitapifeedback@autodesk.com','Revit 2015 API','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></table></div><div id="mainSection"><div id="mainBody"><div class="summary">
   Posts a failure to be displayed to the user at the end of transaction.
</div><p /><b>Namespace:</b> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><b>Assembly:</b> <span sdata="assembly">RevitAPI</span> (in RevitAPI.dll) Version: 2015.0.0.0 (2015.0.0.0)<br /><b>Since:</b> 
   2011
<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <a href="f0fa1b40-5df3-ddaf-e38d-85bd438a89e3.htm">FailureMessageKey</a> <span class="identifier">PostFailure</span>(
	<a href="d0795bd6-f092-90f2-5c2c-3876e616454c.htm">FailureMessage</a> <span class="parameter">failure</span>
)</pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">PostFailure</span> ( _
	<span class="parameter">failure</span> <span class="keyword">As</span> <a href="d0795bd6-f092-90f2-5c2c-3876e616454c.htm">FailureMessage</a> _
) <span class="keyword">As</span> <a href="f0fa1b40-5df3-ddaf-e38d-85bd438a89e3.htm">FailureMessageKey</a></pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span>:
<a href="f0fa1b40-5df3-ddaf-e38d-85bd438a89e3.htm">FailureMessageKey</a>^ <span class="identifier">PostFailure</span>(
	<a href="d0795bd6-f092-90f2-5c2c-3876e616454c.htm">FailureMessage</a>^ <span class="parameter">failure</span>
)</pre></td></tr></table></span></div><div id="parameters"><h4 class="subHeading">Parameters</h4><dl paramName="failure"><dt><span class="parameter">failure</span></dt><dd>Type: <a href="d0795bd6-f092-90f2-5c2c-3876e616454c.htm">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>FailureMessage</a><br />
   The failure to be posted.
</dd></dl></div><h4 class="subHeading">Return Value</h4>
   A unique key that identifies posted failure message in a document. If exactly the same error is posted more than once,
   and not removed between the postings, returned key will be the same every time.
</div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="">
   If code inside transaction detects a problem that needs to be communicated to the user,
   it should report these conditions via this method. Failures will be validated and possibly
   resolved at the end of transaction.
   Warnings posted via this method will not be stored in the document after they are resolved.
   A unique key returned by postFailure can be stored for the lifetime of transaction and used to
   remove failure message if it is no longer relevant.
</div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/copycode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">// Execute function for an Updater triggered when new FamilyInstances are added</span>
<span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> Execute(UpdaterData data)
{
    Document doc = data.GetDocument();
    Autodesk.Revit.ApplicationServices.Application app = doc.Application;
    <span class="highlight-keyword">foreach</span> (ElementId id <span class="highlight-keyword">in</span> data.GetModifiedElementIds())
    {
        FamilyInstance fi = doc.GetElement(id) <span class="highlight-keyword">as</span> FamilyInstance;
        <span class="highlight-keyword">if</span> (fi.StructuralType == StructuralType.Beam)
        {
            AnalyticalModel analyticalModel = fi.GetAnalyticalModel();
            <span class="highlight-keyword">if</span> (analyticalModel.IsSingleCurve() == <span class="highlight-keyword">true</span>)
            {
                Curve beamCurve = analyticalModel.GetCurve();
                <span class="highlight-comment">// enforce beam length minimum of 12 inches</span>
                <span class="highlight-keyword">if</span> (beamCurve.Length &lt; <span class="highlight-number">12.0</span>)
                {
                    FailureMessage failMessage =
                        <span class="highlight-keyword">new</span> FailureMessage(BuiltInFailures.CurveFailures.TooShort);
                    failMessage.SetFailingElement(id);
                    doc.PostFailure(failMessage);
                }
            }
        }
    }
}</pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/copycode.gif" />Copy</span>VB.NET</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">' Execute function for an Updater triggered when new FamilyInstances are added</span>
<span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> Execute(data <span class="highlight-keyword">As</span> UpdaterData) <span class="highlight-keyword">Implements</span> IUpdater.Execute
    <span class="highlight-keyword">Dim</span> doc <span class="highlight-keyword">As</span> Document = data.GetDocument()
    <span class="highlight-keyword">Dim</span> app <span class="highlight-keyword">As</span> Autodesk.Revit.ApplicationServices.Application = doc.Application
    <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> id <span class="highlight-keyword">As</span> ElementId <span class="highlight-keyword">In</span> data.GetModifiedElementIds()
        <span class="highlight-keyword">Dim</span> fi <span class="highlight-keyword">As</span> FamilyInstance = <span class="highlight-keyword">TryCast</span>(doc.GetElement(id), FamilyInstance)
        <span class="highlight-keyword">If</span> fi.StructuralType = StructuralType.Beam <span class="highlight-keyword">Then</span>
            <span class="highlight-keyword">Dim</span> analyticalModel <span class="highlight-keyword">As</span> AnalyticalModel = fi.GetAnalyticalModel()
            <span class="highlight-keyword">If</span> analyticalModel.IsSingleCurve() = <span class="highlight-keyword">True</span> <span class="highlight-keyword">Then</span>
                <span class="highlight-keyword">Dim</span> beamCurve <span class="highlight-keyword">As</span> Curve = analyticalModel.GetCurve()
                <span class="highlight-comment">' enforce beam length minimum of 12 inches</span>
                <span class="highlight-keyword">If</span> beamCurve.Length &lt; <span class="highlight-number">12.0</span> <span class="highlight-keyword">Then</span>
                    <span class="highlight-keyword">Dim</span> failMessage <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> FailureMessage(BuiltInFailures.CurveFailures.TooShort)
                    failMessage.SetFailingElement(id)
                    doc.PostFailure(failMessage)
                <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
            <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
    <span class="highlight-keyword">Next</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(exceptionsToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exceptionsToggle, event)" tabindex="0"><img id="exceptionsToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Exceptions</span></h1><div id="exceptionsSection" class="section" name="collapseableSection" style=""><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th class="exceptionNameColumn">Exception</th><th class="exceptionConditionColumn">Condition</th></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentNullException</a></td><td>
   A non-optional argument was NULL
</td></tr><tr><td><a href="53205486-5917-7c33-8e67-e362106ddc97.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ModificationForbiddenException</a></td><td>
   The document is in failure mode: an operation has failed,
   and Revit requires the user to either cancel the operation
   or fix the problem (usually by deleting certain elements).
   -or-
   The document is being loaded, or is in the midst of another
   sensitive process.
</td></tr><tr><td><a href="8f025460-c283-ea99-aa8a-5a36e11528f4.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ModificationOutsideTransactionException</a></td><td>
   The document has no open transaction.
</td></tr></table></div></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document Class</a></div><div class="seeAlsoStyle"><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div></div>
